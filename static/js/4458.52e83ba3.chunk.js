"use strict";(self.webpackChunkmaterialpro_main=self.webpackChunkmaterialpro_main||[]).push([[4458],{79463:(e,s,t)=>{t.d(s,{Z:()=>o});var i=t(72791),l=t(11087),a=t(30690),n=t.n(a),d=t(80184);const o=e=>{let{menuOptions:s,taskId:t,status:a,action:o,progress:c}=e;const[r,v]=(0,i.useState)(!1),u=()=>{v(!1),o()};return(0,d.jsxs)("div",{className:"action",children:[(0,d.jsx)("button",{type:"button",className:"btn-option ".concat(r&&"active"),onClick:()=>v(!0),children:(0,d.jsx)(n(),{icon:"more_vert"})}),r&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"action-overlay",onClick:()=>v(!1)}),(0,d.jsx)("div",{className:"action-options rounded-3",children:null===s||void 0===s?void 0:s.options.map((e=>(0,d.jsx)("div",{children:"button"===e.type?(0,d.jsxs)("button",{type:"button",className:"text-muted",onClick:()=>{return s=e.to,o(t,s),void v(!1);var s},disabled:e.to===a||2===e.to&&0===a||2===e.to&&4===a||0===e.to&&4===a||2===e.to&&100!==c,children:[e.icon,e.label]}):"link"===e.type?(0,d.jsxs)(l.rU,{className:"text-muted",onClick:e.to,children:[e.icon,e.label]}):(0,d.jsx)("div",{className:"action-del",children:(0,d.jsxs)("button",{type:"button",onClick:u,children:[(0,d.jsx)(n(),{icon:"delete_outline"}),"Delete"]})})},e.id)))})]})]})}},31043:(e,s,t)=>{t.d(s,{F:()=>a,Z:()=>n});t(72791);var i=t(65218),l=t(80184);const a=()=>(0,l.jsx)(i.x7,{toastOptions:{className:"",style:{}}}),n=(e,s)=>{((e,s)=>{"success"===e?i.ZP.success(s):"create"===e?(0,i.ZP)(s,{icon:"\ud83e\udd17"}):"start"===e?(0,i.ZP)("Lets get started, cheer up!",{icon:"\ud83d\udcaa"}):"done"===e?(0,i.ZP)("Horeee, task done!",{icon:"\ud83d\udc4f"}):i.ZP.error(s)})(e,s)}},21234:(e,s,t)=>{t.d(s,{Z:()=>n});var i=t(72791),l=t(84028),a=t(80184);const n=e=>{const{title:s,id:t}=e,[n,d]=(0,i.useState)(!1);return(0,a.jsx)("span",{children:(0,a.jsx)(l.Z,{placement:"top",isOpen:n,target:"tooltip-".concat(t),toggle:()=>d(!n),children:s})})}},74458:(e,s,t)=>{t.d(s,{Z:()=>D});var i=t(72791),l=t(46724),a=t(55211),n=t(94938),d=t(76167),o=t(42976),c=t(8118),r=t(19127),v=t(16354),u=t(69399),m=t(30690),h=t.n(m),x=t(55472),p=t(90235),j=t(57689),g=t(11087),f=t(79463),_=t(87681),k=t(48089),b=t(90838),y=t(17834),N=t(21234),Z=t(31043),S=t(80184);const D=e=>{var s,t,m,D,w,C,F,z;let{modal:T,setModal:O,toggle:P,task:U,refetch:E,mode:I}=e;const{projectId:A}=(0,j.UO)(),{auth:M}=(0,y.Z)(),[L,R]=(0,i.useState)(),[W,V]=(0,i.useState)(!1),[H,q]=(0,i.useState)(""),[B,G]=(0,i.useState)([]),[J,K]=(0,i.useState)(),[Q,X]=(0,i.useState)(!1),[Y,$]=(0,i.useState)(!1),[ee,se]=(0,i.useState)(!1),[te,ie]=(0,i.useState)(),[le,ae]=(0,i.useState)(),[ne,de]=(0,i.useState)(!1),[oe,ce]=(0,i.useState)([]),[re,ve]=(0,i.useState)(),[ue,me]=(0,i.useState)(!1),[he,xe]=(0,i.useState)([]),pe=(0,i.useRef)(),je=(0,k.Z)(),ge=(0,p.ZP)();(0,i.useEffect)((()=>{q({approval_id:null===U||void 0===U?void 0:U.approval_id,task_title:null===U||void 0===U?void 0:U.task_title,task_desc:null===U||void 0===U?void 0:U.task_desc,task_progress:null===U||void 0===U?void 0:U.task_progress,start_date:null===U||void 0===U?void 0:U.start_date,end_date:null===U||void 0===U?void 0:U.end_date}),null!==U&&void 0!==U&&U.pics&&G(U.pics.map((e=>({label:e.first_name,value:e.employe_id})))),xe(null===U||void 0===U?void 0:U.files),async function(){await je.get("api/comment/".concat(null===U||void 0===U?void 0:U.task_id)).then((e=>ie(e.data.data)))}(),async function(){await je.get("api/task/history/".concat(null===U||void 0===U?void 0:U.task_id)).then((e=>{R(e.data.data)}))}()}),[U]),(0,i.useEffect)((()=>{!async function(){await je.get("api/employe/assignment-list").then((e=>K(e.data.data))).catch((e=>console.log(e)))}()}),[]),(0,i.useEffect)((()=>{ve(null===L||void 0===L?void 0:L.concat(te))}),[L,te]);const fe={taskId:null===U||void 0===U?void 0:U.task_id,options:[{id:1,type:"delete",to:"toDelete"}]},_e="https://api.ptpema.co.id/";return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(l.Z,{isOpen:T,toggle:P.bind(null),size:"xl",fade:!1,centered:!0,children:[(0,S.jsx)(a.Z,{toggle:P.bind(null)}),(0,S.jsx)(n.Z,{children:W?(0,S.jsx)("div",{className:"d-flex justify-content-center",style:{height:"400px"},children:"Loading.."}):(0,S.jsxs)("div",{className:"popup-body",children:[(0,S.jsx)("div",{className:"left",children:"activities"===I||2===(null===U||void 0===U?void 0:U.status)||3===(null===U||void 0===U?void 0:U.status)?(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:"top",children:[(0,S.jsxs)("div",{className:"date",children:[(0,S.jsx)("h6",{children:"Start Date "}),(0,S.jsx)("span",{children:(null===H||void 0===H?void 0:H.start_date)||"-"})]}),(0,S.jsxs)("div",{className:"date",children:[(0,S.jsx)("h6",{children:"Due Date"}),(0,S.jsx)("span",{children:(null===H||void 0===H?void 0:H.end_date)||"-"})]})]}),(0,S.jsxs)("div",{className:"bottom mt-3",children:[(0,S.jsxs)(d.Z,{children:[(0,S.jsx)(o.Z,{htmlFor:"taskTitle",children:"Task Title"}),(0,S.jsx)(c.Z,{type:"text",id:"taskTitle",name:"taskTitle",value:(null===H||void 0===H?void 0:H.task_title)||"",readOnly:!0,disabled:!0})]}),(0,S.jsxs)(d.Z,{children:[(0,S.jsx)(o.Z,{htmlFor:"taskDesc",children:"Description"}),(0,S.jsx)(c.Z,{type:"textarea",id:"taskDesc",name:"taskDesc",value:(null===H||void 0===H?void 0:H.task_desc)||"",readOnly:!0,disabled:!0})]}),(0,S.jsxs)(d.Z,{children:[(0,S.jsx)("span",{children:"PICs"}),(0,S.jsx)("br",{}),(0,S.jsx)("div",{className:"d-flex flex-column",children:B.map(((e,s)=>(0,S.jsxs)("div",{className:"d-flex gap-3",children:[(0,S.jsxs)("span",{children:[s+1,"."]}),(0,S.jsx)("span",{children:e.label})]},e.value)))})]})]}),(0,S.jsxs)("div",{className:"attach",children:[(0,S.jsxs)("h6",{children:["Attachment files (",(null===U||void 0===U||null===(s=U.files)||void 0===s?void 0:s.length)||0,")"]}),(0,S.jsx)("ul",{children:(null===U||void 0===U||null===(t=U.files)||void 0===t?void 0:t.length)>0&&he.map((e=>(0,S.jsx)("div",{className:"d-flex gap-1 align-items-center",children:(0,S.jsx)("li",{children:(0,S.jsx)(g.rU,{className:"file-link",to:"".concat(_e,"taskfiles/").concat(e.file_name),target:"_blank",children:e.file_name})})},e.file_id)))})]})]})}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),$(!0),0!==B.length?(H.pic=B,H.project_id=A,oe&&(H.files=oe),await je.patch("api/task/".concat(null===U||void 0===U?void 0:U.task_id),H).then((()=>{(0,Z.Z)("success","Task has been updated."),O(!1),E()})).catch((()=>(0,Z.Z)("error","Something went wrong")))):(0,Z.Z)("error","Field employee cannot be empty"),$(!1)},children:[(0,S.jsxs)("div",{className:"top",children:[(0,S.jsxs)("div",{className:"date",children:[(0,S.jsx)("h6",{children:"Start Date"}),(0,S.jsx)(c.Z,{type:"date",name:"start_date",value:(null===H||void 0===H?void 0:H.start_date)||"",onChange:e=>q({...H,start_date:e.target.value})})]}),(0,S.jsxs)("div",{className:"date",children:[(0,S.jsx)("h6",{children:"Due Date"}),(0,S.jsx)(c.Z,{type:"date",name:"end_date",value:(null===H||void 0===H?void 0:H.end_date)||"",onChange:e=>q({...H,end_date:e.target.value})})]})]}),(0,S.jsxs)("div",{className:"bottom mt-3",children:[(0,S.jsx)(c.Z,{type:"text",name:"task_title",value:(null===H||void 0===H?void 0:H.task_title)||"",onChange:e=>q({...H,task_title:e.target.value})}),(0,S.jsx)(c.Z,{type:"textarea",cols:"5",rows:"6",name:"task_desc",value:(null===H||void 0===H?void 0:H.task_desc)||"",onChange:e=>q({...H,task_desc:e.target.value})}),(null===U||void 0===U?void 0:U.child)>0?"":null===U||void 0===U||null===(m=U.pics)||void 0===m?void 0:m.map((e=>e.employe_id.toString()===(null===M||void 0===M?void 0:M.user.employe_id)&&(0,S.jsxs)("div",{className:"d-flex gap-2 justify-content-between",children:[(0,S.jsx)("div",{className:"col-sm-10",children:(0,S.jsx)(c.Z,{type:"range",defaultValue:U.task_progress,onChange:e=>q({...H,task_progress:e.target.value})})}),(0,S.jsxs)("div",{className:"col-sm-1 d-flex justify-content-end",children:[null===H||void 0===H?void 0:H.task_progress,"%"]})]},e.id)))]}),(0,S.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[(0,S.jsx)("div",{className:"d-flex align-items-center gap-3",children:(0,S.jsxs)("button",{type:"button",className:"btn-assigne",onClick:()=>{X(!0)},children:[(0,S.jsx)("i",{className:"bi-person-plus-fill"}),(0,S.jsx)("span",{children:(null===B||void 0===B?void 0:B.length)||0})]})}),(0,S.jsx)(r.Z,{type:"submit",className:"btn",color:"info",disabled:Y||3===(null===U||void 0===U?void 0:U.status),size:"sm",children:Y?"Updating...":"Update"})]})]}),(0,S.jsxs)("form",{onSubmit:async e=>{var s;e.preventDefault(),0===(null===oe||void 0===oe?void 0:oe.length)?(0,Z.Z)("error","Field cannot be empty"):(null===(s=oe[0])||void 0===s?void 0:s.size)>1048576?(0,Z.Z)("error","Maximum file size is 10mb"):(se(!0),await je.post("api/task/".concat(U.task_id,"/upload"),oe,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{var s;null===U||void 0===U||null===(s=U.files)||void 0===s||s.push(e.data.file),(0,Z.Z)("success","File has been uploaded.")})).catch((()=>{(0,Z.Z)("error","Upload file failed")})),ce([]),se(!1))},className:"mt-2",children:[(0,S.jsxs)("h6",{children:["Attachment files (",(null===U||void 0===U||null===(D=U.files)||void 0===D?void 0:D.length)||0,")"]}),(0,S.jsxs)("div",{className:"d-flex justify-content-between align-items-center bg-light px-2 rounded-3 mt-2",children:[(0,S.jsxs)("div",{className:"d-flex align-items-center gap-1",children:[(0,S.jsxs)("div",{className:"pt-2",id:"tooltip-3",children:[(0,S.jsx)(o.Z,{for:"attach",children:(0,S.jsx)(h(),{icon:"attach_file",className:"btn-icon"})}),(0,S.jsx)("input",{type:"file",id:"attach",name:"attach",hidden:!0,onChange:e=>ce(e.target.files)}),(0,S.jsx)(N.Z,{title:"Upload file",id:"3"})]}),(0,S.jsx)("span",{style:{color:"#1F88E5",fontSize:"12px"},children:oe[0]?null===(w=oe[0])||void 0===w?void 0:w.name:(0,S.jsx)("span",{style:{color:"#68757C"},children:"Max. 10mb"})})]}),(0,S.jsx)(r.Z,{type:"submit",className:"btn",outline:!0,size:"sm",disabled:3===(null===U||void 0===U?void 0:U.status),children:ee?"Uploading...":"Upload"})]})]}),(0,S.jsx)("div",{className:"attach",children:(0,S.jsx)("ul",{children:(null===U||void 0===U||null===(C=U.files)||void 0===C?void 0:C.length)>0&&he.map((e=>(0,S.jsxs)("div",{className:"d-flex gap-1 align-items-center",children:[(0,S.jsx)("li",{children:(0,S.jsx)(g.rU,{className:"file-link",to:"".concat(_e,"taskfiles/").concat(e.file_name),target:"_blank",children:e.file_name})}),(0,S.jsx)("button",{type:"button",className:"btn d-flex",style:{color:"#EF6767"},disabled:ue,onClick:()=>(async e=>{me(!0),await je.delete("api/task/file/delete/".concat(e)).then((()=>{E(),O(!1),(0,Z.Z)("success","A file has been deleted")})).catch("error","Delete file failed"),me(!1)})(e.file_id),children:ue?"Deleting..":(0,S.jsx)(h(),{icon:"delete_outline",style:{fontSize:"20px"}})})]},e.file_id)))})})]})}),(0,S.jsxs)("div",{className:"right",children:[(0,S.jsxs)("div",{className:"top",children:[null===U.task_parent?(0,S.jsxs)("div",{className:"status",children:[(0,S.jsx)("span",{className:"badge bg-light-success text-primary rounded-pill d-inline-block fw-bold",children:"Task"}),0===(null===U||void 0===U?void 0:U.status)?(0,S.jsx)(v.Z,{color:"info",children:"To Do"}):1===(null===U||void 0===U?void 0:U.status)?(0,S.jsx)(v.Z,{color:"primary",children:"In Progress"}):2===(null===U||void 0===U?void 0:U.status)?(0,S.jsxs)(v.Z,{color:"light",className:"text-dark",children:[(0,S.jsx)("i",{className:"bi-clock mr-4",style:{fontSize:"12px"}}),"\xa0 Waiting for approval",(0,S.jsx)("strong",{})]}):3===(null===U||void 0===U?void 0:U.status)?(0,S.jsxs)(v.Z,{color:"success",className:"d-flex",children:[" ",(0,S.jsx)("i",{className:"bi-check2-circle mr-4",style:{fontSize:"13px"}}),"\xa0 Approved"]}):(0,S.jsx)(v.Z,{color:"danger",children:"Revision"})]}):(0,S.jsx)("div",{className:"status",children:(0,S.jsx)("span",{className:"badge bg-light-success text-primary rounded-pill d-inline-block fw-bold",children:"Subtask"})}),(null===M||void 0===M?void 0:M.user.employe_id)===(null===U||void 0===U||null===(F=U.employe_id)||void 0===F?void 0:F.toString())&&(0,S.jsx)(f.Z,{menuOptions:fe,action:async()=>{V(!0),await je.delete("api/task/".concat(U.task_id)).then((()=>(0,Z.Z)("success","Task has been deleted"))).catch((()=>(0,Z.Z)("error","Something went wrong"))),V(!1),O(!1),E()}})]}),(0,S.jsx)("div",{className:"bottom",children:L&&te?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:"history-item",children:[(0,S.jsxs)("div",{className:"comment-name",children:[(0,S.jsxs)("span",{children:[(0,S.jsx)("strong",{children:U&&U.created_by})," create this task"]}),(0,S.jsx)("br",{})]}),(0,S.jsx)("small",{children:U&&(0,b.Z)(U.created_at)})]}),null===(ke=re,z=null===ke||void 0===ke?void 0:ke.sort(((e,s)=>e.created_at.localeCompare(s.created_at))))||void 0===z?void 0:z.map(((e,s)=>null!==e&&void 0!==e&&e.approval_id?(0,S.jsxs)(i.Fragment,{children:[(0,S.jsxs)("div",{className:"history-item",children:[(0,S.jsx)("div",{className:"comment-name",children:0===(null===e||void 0===e?void 0:e.status)&&s<1?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("span",{children:[(0,S.jsx)("strong",{children:null===e||void 0===e?void 0:e.pic_task})," sdsd"]}),(0,S.jsx)("br",{}),(0,S.jsxs)("span",{style:{fontSize:"12px"},children:["Deadline: ",null===e||void 0===e?void 0:e.end_date]})]}):0===(null===e||void 0===e?void 0:e.status)&&s>0?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("span",{children:[(0,S.jsx)("strong",{children:null===e||void 0===e?void 0:e.pic_task})," change task to To Do"]}),(0,S.jsx)("br",{}),(0,S.jsxs)("span",{style:{fontSize:"12px"},children:["Deadline: ",null===e||void 0===e?void 0:e.end_date]})]}):0===(null===e||void 0===e?void 0:e.status)?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("span",{children:[(0,S.jsx)("strong",{children:null===e||void 0===e?void 0:e.pic_task})," was assigned"]}),(0,S.jsx)("br",{}),(0,S.jsxs)("span",{style:{fontSize:"12px"},children:["Deadline: ",null===e||void 0===e?void 0:e.end_date]})]}):1===(null===e||void 0===e?void 0:e.status)?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("span",{children:[(0,S.jsx)("strong",{children:null===e||void 0===e?void 0:e.pic_task})," change task to In Progress"]}),(0,S.jsx)("br",{}),(0,S.jsxs)("span",{style:{fontSize:"12px"},children:["Deadline: ",null===e||void 0===e?void 0:e.end_date]})]}):2===(null===e||void 0===e?void 0:e.status)?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("span",{children:[(0,S.jsx)("strong",{children:null===e||void 0===e?void 0:e.pic_task})," change task to Review"]}),(0,S.jsx)("br",{}),(0,S.jsxs)("span",{style:{fontSize:"12px"},children:["Deadline: ",null===e||void 0===e?void 0:e.end_date]})]}):3===(null===e||void 0===e?void 0:e.status)?(0,S.jsxs)("span",{children:[(0,S.jsxs)("strong",{children:[null===e||void 0===e?void 0:e.status_by," "]})," task approved"]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("span",{children:[(0,S.jsxs)("strong",{children:[null===e||void 0===e?void 0:e.status_by," "]}),"change task to Revision"]}),(0,S.jsx)("br",{}),(0,S.jsxs)("span",{style:{fontSize:"12px"},children:["Deadline: ",null===e||void 0===e?void 0:e.end_date]})]})}),(0,S.jsx)("small",{children:(0,b.Z)(null===e||void 0===e?void 0:e.created_at)})]}),(3===(null===e||void 0===e?void 0:e.status)||4===(null===e||void 0===e?void 0:e.status))&&(0,S.jsx)("div",{className:"comment-item mt-1",children:(0,S.jsx)("div",{className:"comment-user ",children:(0,S.jsxs)("div",{className:"comment-teks ".concat(3===(null===e||void 0===e?void 0:e.status)?"text-success":"text-warning"),children:[(0,S.jsx)("small",{style:{fontWeight:"600"},children:3===(null===e||void 0===e?void 0:e.status)?"Comment":"Notes"}),e.notes]})})})]},null===e||void 0===e?void 0:e.approval_id):(0,S.jsx)("div",{className:"comment-item",children:(0,S.jsxs)("div",{className:"comment-user",children:[(0,S.jsx)("img",{src:_,className:"rounded-circle",alt:"avatar",width:"35",height:"35"}),(0,S.jsxs)("div",{className:"comment-teks",children:[(0,S.jsx)("small",{style:{fontWeight:"600"},children:null===e||void 0===e?void 0:e.first_name}),null===e||void 0===e?void 0:e.comment,(0,S.jsx)("div",{className:"comment-time",children:(0,S.jsx)("small",{children:(0,b.Z)(null===e||void 0===e?void 0:e.created_at)})})]},null===e||void 0===e?void 0:e.comment_id)]})},null===e||void 0===e?void 0:e.comment_id)))]}):"Loading..."}),(0,S.jsx)(u.Z,{onSubmit:async e=>{e.preventDefault(),de(!0),le.employe_id=M.user.employe_id,le.task_id=U.task_id,await je.post("api/comment",le).then((e=>ve((s=>[...s,e.data.data])))),de(!1),ae(),e.target.reset()},children:(0,S.jsxs)("div",{className:"input-comment",children:[(0,S.jsx)(c.Z,{type:"text",name:"comment",ref:pe,onChange:e=>ae({comment:e.target.value}),autoComplete:"off"}),(0,S.jsx)("div",{className:"",children:(0,S.jsxs)(r.Z,{className:"btn",outline:!0,color:"info",disabled:ne,type:"submit",children:[(0,S.jsx)(h(),{icon:"send"}),ne?"Sending":"Send"]})})]})})]})]})})]}),(0,S.jsxs)(l.Z,{isOpen:Q,size:"md",fade:!1,centered:!0,children:[(0,S.jsx)(a.Z,{toggle:()=>X(!1),children:"Assigne Employee"}),(0,S.jsx)(n.Z,{children:(0,S.jsx)(x.ZP,{closeMenuOnSelect:!0,components:ge,isMulti:!0,defaultValue:B,options:J,onChange:e=>G(e)})})]})]});var ke}},90838:(e,s,t)=>{t.d(s,{Z:()=>i});const i=e=>{if(e){const s=new Date,t=new Date(e),i=t.toDateString()===s.toDateString()?"Today":t.toDateString(),l=t.toLocaleString().split(",")[1];return"".concat(i,", ").concat(l.split(":")[0],":").concat(l.split(":")[1]," ").concat(l.split(" ")[2]||"")}return e}},87681:(e,s,t)=>{e.exports=t.p+"static/media/user1.6ac95ef9bc0c027733ea.jpg"}}]);
//# sourceMappingURL=4458.52e83ba3.chunk.js.map