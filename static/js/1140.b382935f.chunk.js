(self.webpackChunkmaterialpro_main=self.webpackChunkmaterialpro_main||[]).push([[1140],{24944:(e,s,t)=>{"use strict";t.d(s,{Z:()=>i});t(72791);var l=t(80184);const i=e=>{let{data:s,color:t}=e;return(0,l.jsx)("div",{className:"flex-wrapper",children:(0,l.jsx)("div",{className:"single-chart",children:(0,l.jsxs)("svg",{viewBox:"0 0 36 36",className:"circular-chart ".concat(100===s?"green":100!==s?"blue":t),children:[(0,l.jsx)("path",{className:"circle-bg",d:"M18 2.0845\r a 15.9155 15.9155 0 0 1 0 31.831\r a 15.9155 15.9155 0 0 1 0 -31.831"}),(0,l.jsx)("path",{className:"circle",strokeDasharray:"".concat(s,", 100"),d:"M18 2.0845\r a 15.9155 15.9155 0 0 1 0 31.831\r a 15.9155 15.9155 0 0 1 0 -31.831"}),100===s?(0,l.jsx)("text",{x:"18",y:"22.35",className:"percentage",style:{fontSize:"14px"},children:"\u2714"}):(0,l.jsxs)("text",{x:"18",y:"22.35",className:"percentage",children:[s,"%"]})]})})})}},14097:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});var l=t(72791),i=t(46272),n=t(80184);const a=i.mM.create({body:{paddingTop:35,paddingBottom:65,paddingHorizontal:35},title:{fontSize:10,textAlign:"center"},text:{margin:10,fontSize:10,textAlign:"justify"},image:{marginVertical:4,marginHorizontal:15,width:50,height:50},header:{fontSize:10,marginBottom:5,textAlign:"left",color:"#3f3f3f",fontWeight:"bold"},pageNumber:{position:"absolute",fontSize:10,bottom:30,left:0,right:0,textAlign:"center",color:"grey"},printAt:{position:"absolute",fontSize:8,bottom:30,left:35,right:0,textAlign:"left",color:"grey"},table:{display:"table",width:"auto",borderStyle:"solid",borderWidth:1,borderRightWidth:0,borderBottomWidth:0,color:"#3f3f3f"},tableRow:{margin:"auto",flexDirection:"row"},tableCol:{borderStyle:"solid",borderWidth:1,borderLeftWidth:0,borderTopWidth:0},tableCell:{marginTop:3,marginBottom:3,marginLeft:3,marginRight:3,fontSize:10}}),d=()=>{const e=new Date;return"".concat(e.toDateString(),", ").concat(e.toLocaleString().split(",")[1])},r=e=>{let{projectTitle:s,data:t}=e;return(0,n.jsx)(i.BB,{children:(0,n.jsxs)(i.T3,{style:{...a.body,backgroundColor:"#fff"},children:[(0,n.jsxs)(i.xv,{style:a.header,fixed:!0,children:["Project : ",null===s||void 0===s?void 0:s.project_name]}),(0,n.jsxs)(i.xv,{style:a.header,fixed:!0,children:["Partner : ",null===s||void 0===s?void 0:s.partner]}),(0,n.jsxs)(i.xv,{style:a.header,fixed:!0,children:["Division : ",null===s||void 0===s?void 0:s.division]}),(0,n.jsxs)(i.xv,{style:a.header,fixed:!0,children:["Phase : ",null===s||void 0===s?void 0:s.phase]}),(0,n.jsxs)(i.xv,{style:a.header,fixed:!0,children:["Schema : ","jo"===(null===s||void 0===s?void 0:s.schema)?"Join Operational":"Join Venture"]}),(0,n.jsxs)(i.G7,{style:a.table,children:[(0,n.jsxs)(i.G7,{style:a.tableRow,children:[(0,n.jsx)(i.G7,{style:{...a.tableCol,width:"5%"},children:(0,n.jsx)(i.xv,{style:a.tableCell,children:"No."})}),(0,n.jsx)(i.G7,{style:{...a.tableCol,width:"35%"},children:(0,n.jsx)(i.xv,{style:a.tableCell,children:"Task Title"})}),(0,n.jsx)(i.G7,{style:{...a.tableCol,width:"15%"},children:(0,n.jsx)(i.xv,{style:a.tableCell,children:"Status"})}),(0,n.jsx)(i.G7,{style:{...a.tableCol,width:"15%"},children:(0,n.jsx)(i.xv,{style:a.tableCell,children:"Deadline"})}),(0,n.jsx)(i.G7,{style:{...a.tableCol,width:"30%"},children:(0,n.jsx)(i.xv,{style:a.tableCell,children:"PIC"})})]}),null===t||void 0===t?void 0:t.map(((e,s)=>{var t,d;return(0,n.jsxs)(l.Fragment,{children:[(0,n.jsxs)(i.G7,{style:a.tableRow,children:[(0,n.jsx)(i.G7,{style:{...a.tableCol,width:"5%"},children:(0,n.jsx)(i.xv,{style:{...a.tableCell,textAlign:"center"},children:s+1})}),(0,n.jsx)(i.G7,{style:{...a.tableCol,width:"35%"},children:(0,n.jsx)(i.xv,{style:a.tableCell,children:e.task_title})}),(0,n.jsx)(i.G7,{style:{...a.tableCol,width:"15%"},children:(0,n.jsx)(i.xv,{style:{...a.tableCell,fontSize:"10px"},children:0===e.status?"To do":1===e.status?"In progress":2===e.status?"Under review":3===e.status?"Approved":"Revision"})}),(0,n.jsx)(i.G7,{style:{...a.tableCol,width:"15%"},children:(0,n.jsx)(i.xv,{style:a.tableCell,children:e.end_date})}),(0,n.jsx)(i.G7,{style:{...a.tableCol,width:"30%"},children:null===(t=e.pics)||void 0===t?void 0:t.map((e=>(0,n.jsx)(i.xv,{style:a.tableCell,children:e.first_name},e.id)))})]}),null===(d=e.level_2)||void 0===d?void 0:d.map((e=>{var s;return(0,n.jsxs)(i.G7,{style:a.tableRow,children:[(0,n.jsx)(i.G7,{style:{...a.tableCol,width:"5%"},children:(0,n.jsx)(i.xv,{style:a.tableCell})}),(0,n.jsx)(i.G7,{style:{...a.tableCol,width:"35%"},children:(0,n.jsx)(i.xv,{style:a.tableCell,children:e.task_title})}),(0,n.jsx)(i.G7,{style:{...a.tableCol,width:"15%"},children:(0,n.jsx)(i.xv,{style:a.tableCell,children:"-"})}),(0,n.jsx)(i.G7,{style:{...a.tableCol,width:"15%"},children:(0,n.jsx)(i.xv,{style:a.tableCell,children:e.end_date})}),(0,n.jsx)(i.G7,{style:{...a.tableCol,width:"30%"},children:null===(s=e.pics)||void 0===s?void 0:s.map((e=>(0,n.jsx)(i.xv,{style:a.tableCell,children:e.first_name},e.id)))})]},e.task_id)}))]},e.task_id)}))]}),(0,n.jsx)(i.xv,{style:a.pageNumber,render:e=>{let{pageNumber:s,totalPages:t}=e;return"".concat(s," / ").concat(t)}}),(0,n.jsx)(i.xv,{style:a.printAt,render:d})]})})}},26067:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>Ue});var l=t(72791),i=t(39773),n=t(43464),a=t(49037),d=t(63009),r=t(14448),c=t(52007),o=t.n(c),u=t(81694),h=t.n(u),x=t(9622),m=["children","className","barClassName","cssModule","value","min","max","animated","striped","color","bar","multi","tag","style","barStyle","barAriaValueText","barAriaLabelledBy"];function v(){return v=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},v.apply(this,arguments)}function j(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);s&&(l=l.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.push.apply(t,l)}return t}function p(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?j(Object(t),!0).forEach((function(s){g(e,s,t[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):j(Object(t)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}))}return e}function g(e,s,t){return s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}function f(e,s){if(null==e)return{};var t,l,i=function(e,s){if(null==e)return{};var t,l,i={},n=Object.keys(e);for(l=0;l<n.length;l++)t=n[l],s.indexOf(t)>=0||(i[t]=e[t]);return i}(e,s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(l=0;l<n.length;l++)t=n[l],s.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var b={animated:o().bool,bar:o().bool,barAriaLabelledBy:o().string,barAriaValueText:o().string,barClassName:o().string,barStyle:o().object,children:o().node,className:o().string,cssModule:o().object,color:o().string,max:o().oneOfType([o().string,o().number]),min:o().oneOfType([o().string,o().number]),multi:o().bool,striped:o().bool,style:o().object,tag:x.iC,value:o().oneOfType([o().string,o().number])};function y(e){var s=e.children,t=e.className,i=e.barClassName,n=e.cssModule,a=e.value,d=void 0===a?0:a,r=e.min,c=void 0===r?0:r,o=e.max,u=void 0===o?100:o,j=e.animated,g=e.striped,b=e.color,y=e.bar,N=e.multi,_=e.tag,Z=void 0===_?"div":_,w=e.style,S=void 0===w?{}:w,k=e.barStyle,C=void 0===k?{}:k,O=e.barAriaValueText,z=e.barAriaLabelledBy,I=f(e,m),A=(0,x.He)(d)/(0,x.He)(u)*100,F=(0,x.mx)(h()(t,"progress"),n),P={className:(0,x.mx)(h()("progress-bar",y&&t||i,j?"progress-bar-animated":null,b?"bg-".concat(b):null,g||j?"progress-bar-striped":null),n),style:p(p(p({},y?S:{}),C),{},{width:"".concat(A,"%")}),role:"progressbar","aria-valuenow":d,"aria-valuemin":c,"aria-valuemax":u,"aria-valuetext":O,"aria-labelledby":z,children:s};return y?l.createElement(Z,v({},I,P)):l.createElement(Z,v({},I,{style:S,className:F}),N?s:l.createElement("div",P))}y.propTypes=b;const N=y;var _=t(19127),Z=t(46724),w=t(55211),S=t(94938),k=t(76167),C=t(42976),O=t(8118),z=t(73830),I=t(4828),A=t(76807),F=t(30690),P=t.n(F),T=t(57689),D=t(11087),R=t(55472),E=t(90235),L=t(87681),M=t(48089),U=t(90838),B=t(17834),V=t(31043),q=t(21234),G=t(87535),W=t(23606),H=t(80184);const J=(0,E.ZP)(),K=e=>{const s=(new Date).toLocaleString().split(",")[0],t=s.split("/")[1],l=s.split("/")[0],i=s.split("/")[2],n="".concat(i,"-").concat(l,"-").concat(t),a=new Date(n);return(new Date(e).getTime()-a.getTime())/864e5},Y=()=>{var e,s,t,c,o,u;const{auth:h}=(0,B.Z)(),{projectId:x}=(0,T.UO)(),[m,v]=(0,l.useState)(),[j,p]=(0,l.useState)(!1),[g,f]=(0,l.useState)(),[b,y]=(0,l.useState)(),[F,E]=(0,l.useState)(!1),[Y,Q]=(0,l.useState)([]),[X,$]=(0,l.useState)(void 0),[ee,se]=(0,l.useState)(""),[te,le]=(0,l.useState)(),[ie,ne]=(0,l.useState)([]),[ae,de]=(0,l.useState)(void 0),[re,ce]=(0,l.useState)(0),[oe,ue]=(0,l.useState)({todo:0,inprogress:0,underReview:0,done:0}),he=(0,M.Z)(),xe=()=>{p(!j)},{isLoading:me,error:ve,data:je,refetch:pe}=(0,A.a)({queryKey:["overview"],queryFn:()=>he.get("api/project/".concat(x)).then((e=>e.data.data))});(0,l.useEffect)((()=>{var e,s,t,l,i;const n=null===je||void 0===je||null===(e=je.task_by_active_user)||void 0===e?void 0:e.filter((e=>0===parseInt(e.status,10)||4===parseInt(e.status,10))),a=null===je||void 0===je||null===(s=je.task_by_active_user)||void 0===s?void 0:s.filter((e=>1===parseInt(e.status,10))),d=null===je||void 0===je||null===(t=je.task_by_active_user)||void 0===t?void 0:t.filter((e=>2===parseInt(e.status,10)||3===parseInt(e.status,10))),r=null===je||void 0===je||null===(l=je.task_by_active_user)||void 0===l?void 0:l.filter((e=>2===parseInt(e.status,10)));ue({todo:null===n||void 0===n?void 0:n.length,inprogress:null===a||void 0===a?void 0:a.length,underReview:null===r||void 0===r?void 0:r.length,done:null===d||void 0===d?void 0:d.length}),$(null===je||void 0===je||null===(i=je.current_stage)||void 0===i?void 0:i.phase_id),"business"===(null===je||void 0===je?void 0:je.category)?le(!0):le(!1),async function(){await he.post("api/project/progress/collection",{ids:[x]}).then((e=>{var s;ce(null===(s=e.data.data[0])||void 0===s?void 0:s.progress)})).catch((e=>console.log(e)))}()}),[je]);const ge=async()=>{await he.get("api/project/".concat(x,"/history")).then((e=>v(e.data.data))).catch((e=>console.log(e)))};(0,l.useEffect)((()=>{ge()}),[x]),(0,l.useEffect)((()=>{!async function(){await he.get("api/employe/assignment-list").then((e=>y(e.data.data))).catch((e=>console.log(e)))}()}),[]);const fe=["Manager","Director"];return(0,l.useEffect)((()=>{!async function(){await he.get("api/project/partner/options").then((e=>ne(e.data.data))).catch((e=>console.log(e)))}()}),[]),(0,l.useEffect)((()=>{pe()}),[x]),(0,H.jsx)(H.Fragment,{children:me?(0,H.jsx)(i.Z,{lg:"12",children:(0,H.jsx)(n.Z,{children:(0,H.jsx)(a.Z,{children:"Loading..."})})}):ve?"Soemthing went wrong.":(0,H.jsxs)(d.Z,{children:[(0,H.jsxs)(i.Z,{lg:"8",children:[(0,H.jsx)(n.Z,{className:"rounded-3 mb-3",children:(0,H.jsxs)(a.Z,{children:[(0,H.jsx)("div",{children:(0,H.jsx)(r.Z,{tag:"h5",className:"text-dark fw-bold",children:"Description"})}),(0,H.jsx)("div",{className:"ms-auto mt-3 mt-md-0",children:te?null===(e=je.current_stage)||void 0===e?void 0:e.desc:null===je||void 0===je?void 0:je.goals}),(0,H.jsxs)("div",{className:"d-flex justify-content-between mt-3",children:[(0,H.jsxs)("div",{className:"d-flex flex-column",children:[(0,H.jsx)("small",{className:"text-muted",children:"Level"}),(0,H.jsx)("span",{className:"text-dark",children:je.level_desc})]}),(0,H.jsxs)("div",{className:"d-flex flex-column col-4",children:[(0,H.jsx)("small",{className:"text-muted",children:"Base"}),(0,H.jsxs)("div",{className:"d-flex",children:[(0,H.jsx)("span",{className:"wtext-dark",children:(null===je||void 0===je?void 0:je.base_description.trim().length)>25?"".concat(null===je||void 0===je?void 0:je.base_description.substring(0,25),"..."):null===je||void 0===je?void 0:je.base_description}),(0,H.jsx)("abbr",{title:null===je||void 0===je?void 0:je.base_description,children:(0,H.jsx)("i",{className:"me-2 bi-info-circle-fill",style:{fontSize:"14px",marginLeft:"4px"}})})]})]}),(0,H.jsxs)("div",{className:"d-flex flex-column",children:[(0,H.jsx)("small",{className:"text-muted",children:"Start date"}),(0,H.jsx)("span",{className:"text-dark",children:(0,G.Z)((null===je||void 0===je?void 0:je.current_stage)&&(null===(s=je.current_stage)||void 0===s?void 0:s.start_date))})]}),(0,H.jsxs)("div",{className:"d-flex flex-column",children:[(0,H.jsx)("small",{className:"text-muted",children:"Deadline"}),(0,H.jsx)("span",{className:"text-dark",children:(0,G.Z)(null!==(null===je||void 0===je?void 0:je.current_stage)&&(null===(t=je.current_stage)||void 0===t?void 0:t.end_date))})]})]}),(0,H.jsxs)("div",{className:"d-flex justify-content-between bg-light align-items-end p-2 mt-3",style:{borderRadius:"8px"},children:[(0,H.jsxs)("div",{className:"d-flex gap-3 align-items-center",children:[(0,H.jsx)("img",{src:L,className:"rounded-circle",alt:"avatar",width:"45",height:"45"}),(0,H.jsxs)("div",{className:"d-flex flex-column",children:[(0,H.jsx)("small",{className:"text-muted",children:"PIC"}),(0,H.jsx)("span",{className:"text-dark fw-bold",children:je.pic_active.first_name})]})]}),(0,H.jsxs)("div",{className:"d-flex gap-3",children:[(0,H.jsxs)("span",{className:"badge text-info bg-light-info rounded-pill d-inline-block",children:["Est. Cost ",(0,H.jsx)("span",{className:"fw-bold",children:(0,W.Z)(je.estimated_cost)})]}),(0,H.jsxs)("span",{className:"badge text-info bg-light-info rounded-pill d-inline-block",children:["Est. Income ",(0,H.jsx)("span",{className:"fw-bold",children:(0,W.Z)(je.estimated_income)})]})]})]})]})}),(0,H.jsx)(n.Z,{className:"rounded-3",children:(0,H.jsxs)(a.Z,{children:[(0,H.jsx)("div",{children:(0,H.jsx)(r.Z,{tag:"h5",className:"text-dark fw-bold",children:"Project Histories"})}),(0,H.jsx)("div",{className:"d-flex flex-column gap-2",children:m?null===m||void 0===m?void 0:m.map((e=>{var s;return(0,H.jsxs)("div",{className:"col-md-12 d-flex justify-content-between align-items-center py-2 px-3",style:{backgroundColor:"#F3F2F2",borderRadius:"8px"},children:[(0,H.jsxs)("div",{className:"col-md-4 d-flex flex-column",children:[(0,H.jsx)("span",{className:"text-dark",children:e.organization_name}),(0,H.jsx)("small",{children:e.history_desc}),(null===h||void 0===h||null===(s=h.user)||void 0===s?void 0:s.roles.find((e=>fe.includes(e))))&&(0,H.jsx)(D.rU,{to:"/projects/details/".concat(x,"?div=").concat(e.organization_id,"&to=activities"),style:{textDecoration:"none"},children:"See all task"})]}),(0,H.jsx)("div",{className:"col-md-2",children:(0,H.jsx)("span",{className:"badge bg-light-".concat("handover"===e.status&&0===e.active?"danger text-danger":"handover"===e.status?"success text-success":"review"===e.status?"danger text-danger":"primary text-primary"," rounded-pill d-inline-block fw-bold"),children:"handover"===e.status&&0===e.active?"waiting for approval":"handover"===e.status&&1===e.active||1===e.active?"active":e.status})}),(0,H.jsx)("div",{className:"col-md-3 d-flex flex-column",children:(0,H.jsx)("small",{children:(0,U.Z)(e.created_at)})}),(0,H.jsxs)("div",{className:"col-md-1 d-flex justify-content-end",children:[(0,H.jsx)("img",{id:"tooltip-".concat(e.history_id),src:e.img||L,className:"rounded-circle",alt:"avatar",width:"35",height:"35"}),(0,H.jsx)(q.Z,{title:e.first_name,id:e.history_id.toString()})]})]},e.history_id)})):"Loading..."})]})})]}),(0,H.jsxs)(i.Z,{lg:"4",children:[(0,H.jsx)(n.Z,{className:"rounded-3 mb-3",children:(0,H.jsxs)(a.Z,{children:[(0,H.jsxs)(r.Z,{tag:"h5",className:"d-flex justify-content-between fw-bold",children:["Project Active",(0,H.jsxs)("span",{className:"text-success fw-bold",children:[re.toFixed(),"%"]})]}),(0,H.jsx)(N,{className:"",color:"success",value:re.toFixed(),style:{height:"15px"}})]})}),(0,H.jsx)(n.Z,{className:"rounded-3",children:(0,H.jsxs)(a.Z,{children:[(0,H.jsxs)("div",{className:"overall-process",children:[(0,H.jsxs)("div",{className:"overall-child",children:[(0,H.jsxs)("div",{children:[(0,H.jsx)("h6",{className:"text-muted",children:"Remaining days"}),(0,H.jsx)("span",{className:"text-danger",children:K(null!==(null===je||void 0===je?void 0:je.current_stage)&&(null===(c=je.current_stage)||void 0===c?void 0:c.end_date)).toFixed()})]}),(0,H.jsx)(P(),{icon:"timer"})]}),(0,H.jsxs)("div",{className:"overall-child",children:[(0,H.jsxs)("div",{children:[(0,H.jsx)("h6",{className:"text-muted",children:"Task Todo"}),(0,H.jsx)("span",{children:null===oe||void 0===oe?void 0:oe.todo})]}),(0,H.jsx)(P(),{icon:"schedule"})]})]}),(0,H.jsxs)("div",{className:"overall-process",children:[(0,H.jsxs)("div",{className:"overall-child",children:[(0,H.jsxs)("div",{children:[(0,H.jsx)("h6",{className:"text-muted",children:"Task In Progress"}),(0,H.jsx)("span",{children:null===oe||void 0===oe?void 0:oe.inprogress})]}),(0,H.jsx)(P(),{icon:"play_circle_outline"})]}),(0,H.jsxs)("div",{className:"overall-child",children:[(0,H.jsxs)("div",{children:[(0,H.jsx)("h6",{className:"text-muted",children:"Task Done"}),(0,H.jsx)("span",{children:null===oe||void 0===oe?void 0:oe.done})]}),(0,H.jsx)(P(),{icon:"task_alt"})]})]})]})}),te&&h.user.roles.includes("Manager")&&h.user.employe_id===(null===je||void 0===je||null===(o=je.pic_active)||void 0===o?void 0:o.employe_id)&&(0,H.jsx)(n.Z,{children:(0,H.jsx)(_.Z,{type:"button",color:"info",disabled:100!==re||0!==(null===oe||void 0===oe?void 0:oe.underReview)||0!==(null===oe||void 0===oe?void 0:oe.todo)||0!==(null===oe||void 0===oe?void 0:oe.inprogress),outline:!0,onClick:xe.bind(null),children:"Handover Project"})})]}),(0,H.jsxs)(Z.Z,{isOpen:j,toggle:xe.bind(null),size:"md",fade:!1,centered:!0,children:[(0,H.jsx)(w.Z,{toggle:xe.bind(null),children:"Handover Project"}),(0,H.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),E(!0),await he.post("api/project/handover",{project_id:x,new_pic:g.value,file:Y,schema:2===X?ee:"",partner:2===X?ae:""},{headers:{"Content-Type":"multipart/form-data"}}).then((()=>{ge(),(0,V.Z)("success","BAST is under review")})).catch((e=>console.log(e))),E(!1),p(!1)},children:[(0,H.jsxs)(S.Z,{children:[(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{children:"Option"}),(0,H.jsxs)(O.Z,{type:"select",id:"base_id",name:"base_id",defaultValue:"a",children:[(0,H.jsx)("option",{value:"a",disabled:!0,children:"Select"}),(0,H.jsx)("option",{value:"",children:"Hand Over"}),(0,H.jsx)("option",{value:"",children:"Done"})]})]}),2===X&&(0,H.jsxs)(H.Fragment,{children:[null===(null===je||void 0===je||null===(u=je.current_stage)||void 0===u?void 0:u.partner)&&(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{for:"partner",children:"Partner"}),(0,H.jsxs)(O.Z,{type:"select",id:"partner",name:"partner",defaultValue:"pa",onChange:e=>de(e.target.value),children:[(0,H.jsx)("option",{disabled:!0,value:"pa",children:"- Select -"}),ie.length>0&&ie.map((e=>(0,H.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{children:"Schema"}),(0,H.jsxs)(O.Z,{type:"select",id:"base_id",name:"base_id",defaultValue:"a",onChange:e=>se(e.target.value),children:[(0,H.jsx)("option",{value:"a",disabled:!0,children:"Select"}),(0,H.jsx)("option",{value:"jo",children:"JO"}),(0,H.jsx)("option",{value:"jv",children:"JV"})]})]})]}),(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{children:"PIC"}),(0,H.jsx)(R.ZP,{components:J,options:b,onChange:e=>f(e)})]}),(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{htmlFor:"bst",children:"BAST"}),(0,H.jsx)(k.Z,{children:(0,H.jsx)(O.Z,{type:"file",name:"file",id:"bst",onChange:e=>Q(e.target.files)})})]})]}),(0,H.jsxs)(z.Z,{children:[(0,H.jsx)(_.Z,{color:"secondary",outline:!0,onClick:xe.bind(null),children:"Cancel"}),(0,H.jsx)(_.Z,{type:"submit",color:"info",disabled:F,className:"d-flex gap-1 align-items-center",children:F?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(I.Z,{className:"me-2",size:"sm",color:"light"}),"Sending"]}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(P(),{icon:"send",style:{fontSize:"20px"}}),"Send"]})})]})]})]})]})})};var Q=t(16354),X=t(74458);const $=e=>{const{auth:s}=(0,B.Z)(),{projectId:t,setNewTaskOpen:i,setAddSubtaskOpen:n,refetch:a,type:d,taskId:r,title:c,name:o}=e,[u,h]=(0,l.useState)(!1),[x,m]=(0,l.useState)({}),[v,j]=(0,l.useState)(!1),[p,g]=(0,l.useState)([]),[f,b]=(0,l.useState)(),y=(0,E.ZP)(),N=(0,T.s0)(),k=()=>{j(!v)},C=(0,M.Z)();(0,l.useEffect)((()=>{!async function(){await C.get("api/employe/assignment-list?search=".concat(o)).then((e=>{b(e.data.data)})).catch((e=>console.log(e)))}(),g([{value:s.user.employe_id,label:s.user.first_name}])}),[]);const z=e=>{m((s=>({...s,[e.target.name]:e.target.value})))},A=()=>{1===d?i(!1):n(void 0)};return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("div",{className:"task-form-overlay",onClick:A}),(0,H.jsx)("form",{onSubmit:async e=>{e.preventDefault(),h(!0),(null===p||void 0===p?void 0:p.length)>0?(x.project_id=t,x.task_pic=p,2===d&&(x.task_parent=r),await C.post("api/task",x,{headers:{"Content-Type":"multipart/form-data"}}).then((()=>{if(null!==s&&void 0!==s&&s.user.roles.includes("Manager")){const e=[];p.map((s=>e.push(s.value))),e.includes(null===s||void 0===s?void 0:s.user.employe_id)||N("?to=activities")}else N("");(0,V.Z)("create","New task has been created.")})).catch((()=>(0,V.Z)("error","New task failed to save"))),a(),A()):(0,V.Z)("error","Assignment cannot be empty"),h(!1)},style:{width:"100%"},encType:"multipart/form-data",children:(0,H.jsxs)("div",{className:"new-task rounded-3",children:[(0,H.jsx)("div",{className:"body",children:(0,H.jsx)("div",{className:"input",children:(0,H.jsx)(O.Z,{type:"textarea",name:"task_title",placeholder:"".concat(c,"..."),required:!0,onChange:z,rows:"4",value:(null===x||void 0===x?void 0:x.task_title)||"",style:{fontSize:"13px"}})})}),(0,H.jsxs)("div",{className:"d-flex gap-3 justify-content-between",children:[(0,H.jsxs)("div",{className:"d-flex gap-0 w-75",children:[(0,H.jsxs)("div",{className:"d-flex align-items-center w-50",children:[(0,H.jsxs)("span",{className:"datepicker-toggle",children:[(0,H.jsx)("span",{className:"datepicker-toggle-button",children:(0,H.jsx)(P(),{icon:"calendar_month"})}),(0,H.jsx)("input",{type:"date",name:"start_date",className:"datepicker-input",required:!0,onChange:z})]}),(0,H.jsxs)("div",{className:"d-flex flex-column",children:[(0,H.jsx)("small",{className:"text-muted",style:{fontSize:"12px"},children:"Start date"}),(0,H.jsx)("small",{className:"text-dark",style:{marginTop:"-7px"},children:x.start_date})]})]}),(0,H.jsxs)("div",{className:"d-flex align-items-center w-50",children:[(0,H.jsxs)("span",{className:"datepicker-toggle",children:[(0,H.jsx)("span",{className:"datepicker-toggle-button",children:(0,H.jsx)(P(),{icon:"calendar_month"})}),(0,H.jsx)("input",{type:"date",id:"end_date",name:"end_date",className:"datepicker-input",required:!0,onChange:z})]}),(0,H.jsxs)("div",{className:"d-flex flex-column",children:[(0,H.jsx)("small",{htmlFor:"end_date",className:"text-muted",style:{fontSize:"12px"},children:"Due date"}),(0,H.jsx)("small",{className:"text-dark",style:{marginTop:"-7px"},children:x.end_date})]})]})]}),(0,H.jsxs)("div",{children:[(0,H.jsxs)("button",{type:"button",className:"btn-assigne",id:"tooltip-2",onClick:()=>{j(!0)},children:[(0,H.jsx)("i",{className:"bi-person-plus-fill"}),(0,H.jsx)("span",{children:(null===p||void 0===p?void 0:p.length)||0})]}),(0,H.jsx)(q.Z,{title:"Assigne",id:"2"})]})]}),(0,H.jsxs)("div",{className:"footer mt-2",children:[(0,H.jsx)("div",{className:"option"}),(0,H.jsxs)("div",{className:"action",children:[(0,H.jsx)(_.Z,{type:"button",size:"sm",color:"light",disabled:u,onClick:A,children:"Cancel"}),(0,H.jsx)(_.Z,{type:"submit",size:"sm",className:"d-flex gap-2 align-items-center",disabled:u,children:u?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(I.Z,{size:"sm"}),"Loading..."]}):"Save"})]})]})]})}),(0,H.jsxs)(Z.Z,{isOpen:v,toggle:k.bind(null),size:"md",fade:!1,centered:!0,children:[(0,H.jsx)(w.Z,{toggle:k.bind(null),children:"Assign to"}),(0,H.jsx)(S.Z,{children:(0,H.jsx)(R.ZP,{components:y,isMulti:!0,defaultValue:p,options:f,onChange:e=>g(e)})})]})]})};var ee=t(79463),se=t(24944),te=t(77904);const le=e=>{var s;let{itemValue:t,setIsAddingItem:i,setShowAddSub:n,selectedActivityId:a,setSelectedActivityId:d,setItemValue:r,refetch:c}=e;const{auth:o}=(0,B.Z)(),[u,h]=(0,l.useState)(!1),[x,m]=(0,l.useState)({}),[v,j]=(0,l.useState)(),p=(0,E.ZP)(),g=()=>{h(!u)},f=(0,M.Z)();(0,l.useEffect)((()=>{!async function(){await f.get("api/employe/assignment-list?search=subordinate").then((e=>{j(e.data.data)})).catch((e=>console.log(e)))}(),m({value:null===o||void 0===o?void 0:o.user.employe_id,label:null===o||void 0===o?void 0:o.user.first_name})}),[]);const b=e=>{h(e)};return(0,H.jsxs)("div",{className:"form-wrap",children:[(0,H.jsx)("div",{className:"form-input",children:(0,H.jsx)("input",{type:"text",placeholder:"Add Sub Activity...",onChange:e=>r(e.target.value),autoFocus:!0})}),(0,H.jsxs)("div",{className:"form-assigne",children:[(0,H.jsxs)("div",{className:"assigne",children:[(0,H.jsx)("button",{type:"button",className:"btn-assigne",id:"tooltip-2",onClick:()=>b(!0),children:(0,H.jsx)("i",{className:"".concat(null!==o&&void 0!==o&&null!==(s=o.user)&&void 0!==s&&s.roles.includes("Staff")?"bi-person-fill":"bi-person-plus-fill")})}),(0,H.jsx)("span",{children:x.label})]}),(0,H.jsxs)("div",{className:"action",children:[(0,H.jsx)(_.Z,{className:"btn-cancel",type:"button",size:"sm",color:"light",onClick:()=>{n(!1),d(void 0)},children:"Cancel"}),(0,H.jsx)(_.Z,{type:"button",onClick:()=>(async()=>{var e;if(""===t)(0,V.Z)("error","Field cannot be empty");else if(0===(null===(e=Object.keys(x))||void 0===e?void 0:e.length))(0,V.Z)("error","Please select an employee");else{i(!0);const e={sub:[{sub:t,status:"created",employe_id:null===x||void 0===x?void 0:x.value}]};await f.patch("api/task/".concat(a,"/activity/add-sub"),e).then((()=>{c()})).catch((()=>(0,V.Z)("error","Action failed"))),d(),n(!1),i(!1),r({}),m({})}})(),children:"Save"})]}),(0,H.jsxs)(Z.Z,{isOpen:u,toggle:g.bind(null),size:"md",fade:!1,centered:!0,children:[(0,H.jsx)(w.Z,{toggle:g.bind(null),children:"Assign to"}),(0,H.jsx)(S.Z,{children:(0,H.jsx)(R.ZP,{components:p,defaultValue:x,options:v,onChange:e=>{m(e),b(!1)}})})]})]})]})},ie=["Manager"],ne=["Supervisor","Manager"],ae=["Staff","Supervisor","Manager"],de=e=>{var s,t;let{directSupervisor:i,data:n,projectId:a,refetch:d,isMemberActive:r}=e;const{auth:c}=(0,B.Z)(),[o,u]=(0,l.useState)(!1),[h,x]=(0,l.useState)(void 0),[m,v]=(0,l.useState)(void 0),[j,p]=(0,l.useState)(),[g,f]=(0,l.useState)(),[b,y]=(0,l.useState)(),[N,_]=(0,l.useState)(void 0),[Z,w]=(0,l.useState)(!1),[S,k]=(0,l.useState)(""),[C,O]=(0,l.useState)(!1),[z,A]=(0,l.useState)(),[F,T]=(0,l.useState)(),[D,R]=(0,l.useState)(!1),[E,U]=(0,l.useState)(!1),[W,J]=(0,l.useState)(null),[K,Y]=(0,l.useState)(!1),[de,re]=(0,l.useState)(""),ce=(0,M.Z)(),oe=null===c||void 0===c||null===(s=c.user)||void 0===s?void 0:s.roles,ue=null===c||void 0===c||null===(t=c.user)||void 0===t?void 0:t.employe_id,he=e=>{u(!0),v(e)},xe=async(e,s)=>{f(e),y(s),p(!0),await ce.put("api/task/".concat(e,"/status"),{employe_id:c.user.employe_id,status:s}).then((()=>{(0,V.Z)(1===s?"start":2===s?"done":"success","Task status has been changed to ".concat(0===s?"To Do":1===s?"In Progress":"Done"))})).catch((e=>{(0,V.Z)("error",e.response.data.error)})),d(),p(!1),f(),y()},me=e=>{Y(!0),setTimeout((()=>{Y(!1)}),5e3),console.log(e)},ve={options:[{id:1,icon:(0,H.jsx)(P(),{icon:"edit_note"}),type:"button",label:"To do",to:0},{id:2,icon:(0,H.jsx)(P(),{icon:"play_circle_outline"}),type:"button",label:"In Progress",to:1},{id:3,icon:(0,H.jsx)(P(),{icon:"task_alt"}),type:"button",label:"Done",to:2},{id:4,icon:(0,H.jsx)(P(),{icon:"content_copy"}),type:"link",label:"Duplicate",to:"duplicate"}]},je=new URLSearchParams(window.location.search),pe=je.get("task");return(0,l.useEffect)((()=>{J(pe)}),[je]),(0,l.useEffect)((()=>{if(null!==W){const e=document.getElementById(W);null!==e&&e.scrollIntoView()}}),[W]),(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("div",{className:"",children:null===n||void 0===n?void 0:n.map(((e,s)=>{var t,n,c;return(0,H.jsxs)("div",{className:"board rounded-3",children:[(0,H.jsxs)("div",{className:"board-header",children:[(0,H.jsxs)("div",{className:"d-flex gap-2",style:{height:"max-content"},children:[(0,H.jsxs)(Q.Z,{color:"info",className:"bg-light-".concat(0===e.status?"primary":1===e.status?"warning":"success"," text-").concat(0===e.status?"primary":1===e.status?"warning":"success"," fw-bold"),children:["#",s+1]}),4===parseInt(e.status,10)&&(0,H.jsxs)(Q.Z,{color:"danger",children:[(0,H.jsx)("i",{className:"bi-pencil-square mr-4",style:{fontSize:"12px"}}),"\xa0 Revision"]})]}),0===parseInt(e.status,10)||1===parseInt(e.status,10)||4===parseInt(e.status,10)?j&&g===e.task_id?(0,H.jsxs)("div",{className:"d-flex align-items-center gap-1",children:[(0,H.jsx)(I.Z,{size:"sm",color:"success"}),(0,H.jsxs)("span",{style:{fontSize:"12px"},children:["Updating status to"," ",(0,H.jsx)("strong",{children:0===b?"To do":1===b?"In Progress":2===b?"Done":""})]})]}):K?(0,H.jsxs)("div",{className:"d-flex align-items-center gap-1",children:[(0,H.jsx)(I.Z,{size:"sm",color:"success"}),(0,H.jsx)("span",{style:{fontSize:"12px"},children:"Duplicating the task.."})]}):(0,H.jsxs)("div",{className:"d-flex gap-2",children:[(0,H.jsx)("div",{className:"",children:1===parseInt(e.status,10)&&(0,H.jsxs)("span",{style:{fontSize:"12px"},children:["Progress","  ",(0,H.jsxs)("strong",{style:{fontSize:"14px",color:100===e.task_progress?"#4cc790":"#21C1D6"},children:[e.task_progress.toFixed(),"%"]})]})}),(0,H.jsx)("div",{children:r&&(0,H.jsx)(ee.Z,{menuOptions:ve,taskId:e.task_id,status:parseInt(e.status,10),action:xe,progress:e.task_progress,duplicateFn:me})},e.task_id)]}):2===parseInt(e.status,10)?(0,H.jsxs)(Q.Z,{color:"light",className:"d-flex text-dark",children:[(0,H.jsx)("i",{className:"bi-clock mr-4",style:{fontSize:"12px"}}),"\xa0 Waiting for approval"]}):3===parseInt(e.status,10)?(0,H.jsxs)(Q.Z,{color:"success",className:"d-flex",children:[(0,H.jsx)("i",{className:"bi-check2-circle mr-4",style:{fontSize:"13px"}}),"\xa0 Approved"]}):""]}),(0,H.jsxs)("div",{className:"board-body task ".concat(pe===e.task_id.toString()&&"bg-light-warning"),children:[(0,H.jsx)("div",{className:"task-title fw-bold",onClick:()=>he(e),id:e.task_id.toString()===W?W:"",children:e.task_title}),(0,H.jsxs)("div",{className:"task-bottom",children:[(0,H.jsx)("div",{className:"task-info",children:oe.find((e=>null===ie||void 0===ie?void 0:ie.includes(e)))&&2!==parseInt(e.status,10)&&3!==parseInt(e.status,10)&&(0,H.jsx)("button",{type:"button",className:"add-child",onClick:()=>x(e.task_id),children:(0,H.jsx)(P(),{icon:"add_circle"})})}),(0,H.jsx)("div",{className:"task-action",children:(0,H.jsxs)("div",{className:"comment",children:[(0,H.jsx)(P(),{icon:"comment"}),(0,H.jsx)("div",{children:e.comments})]})})]}),h===e.task_id&&(0,H.jsx)("div",{className:"p-1",children:(0,H.jsx)($,{projectId:a,setAddSubtaskOpen:x,refetch:d,type:2,title:"Add new target..",taskId:e.task_id})})]}),(null===(t=e.level_2)||void 0===t?void 0:t.length)>0&&e.level_2.map((s=>{var t;return(0,H.jsxs)("div",{className:"board-container",children:[(0,H.jsxs)("div",{className:"board-body subtask ".concat(pe===s.task_id.toString()&&"bg-light-warning"),children:[(0,H.jsx)("div",{className:"task-title",onClick:()=>he(s),id:s.task_id.toString()===W?W:"",children:s.task_title}),(0,H.jsxs)("div",{className:"task-bottom",children:[(0,H.jsx)("div",{className:"task-info",children:oe.find((e=>null===ne||void 0===ne?void 0:ne.includes(e)))&&2!==parseInt(e.status,10)&&3!==parseInt(e.status,10)&&(0,H.jsx)("button",{type:"button",className:"add-child",onClick:()=>x(s.task_id),children:(0,H.jsx)(P(),{icon:"add_circle"})})}),(0,H.jsxs)("div",{className:"task-action",children:[(0,H.jsx)("div",{className:"circular-progress",children:(0,H.jsx)(se.Z,{data:parseInt(s.task_progress.toFixed(),10)})}),(0,H.jsxs)("div",{className:"comment",children:[(0,H.jsx)(P(),{icon:"comment"}),(0,H.jsx)("div",{children:s.comments})]})]})]}),h===s.task_id&&(0,H.jsx)("div",{className:"p-1",children:(0,H.jsx)($,{projectId:a,setAddSubtaskOpen:x,refetch:d,type:2,title:"Add new activity..",taskId:s.task_id,name:"activity"})})]},s.task_id),(null===(t=s.level_3)||void 0===t?void 0:t.length)>0&&s.level_3.map((s=>{var t;return(0,H.jsxs)("div",{className:"board-body subtask-level3 ".concat(pe===s.task_id.toString()&&"bg-light-warning"),children:[(0,H.jsx)("div",{className:"task-title",onClick:()=>{he(s),re("activity")},children:s.task_title}),(0,H.jsxs)("div",{className:"task-bottom",children:[(0,H.jsxs)("div",{className:"task-info",children:[(0,H.jsxs)("span",{className:"text-muted",children:[null!==s.sub?JSON.parse(s.sub).length:0," Sub"]}),oe.find((e=>null===ae||void 0===ae?void 0:ae.includes(e)))&&s.task_id!==N&&2!==parseInt(e.status,10)&&3!==parseInt(e.status,10)&&(0,H.jsx)("button",{type:"button",className:"add-child",onClick:()=>(e=>{if(null!==oe&&void 0!==oe&&oe.includes("Staff")){const s=[];for(let t=0;t<(null===e||void 0===e?void 0:e.pics.length);t++)s.push(e.pics[t].employe_id.toString());s.includes(i)||s.includes(ue)?(w(!0),_(e.task_id)):(0,V.Z)("error","You are not allowed")}else w(!0),_(e.task_id)})(s),children:(0,H.jsx)(P(),{icon:"add"})})]}),(0,H.jsxs)("div",{className:"task-action",children:[(0,H.jsx)("div",{className:"circular-progress",children:(0,H.jsx)(se.Z,{data:parseInt(s.task_progress.toFixed(),10)})}),(0,H.jsxs)("div",{className:"comment",children:[(0,H.jsx)(P(),{icon:"comment"}),(0,H.jsx)("div",{children:s.comments})]})]})]}),Z&&(0,H.jsx)("div",{className:"add-item",children:C&&N===s.task_id?(0,H.jsxs)("div",{className:"saving",children:[(0,H.jsx)(I.Z,{size:"sm",color:"success"}),(0,H.jsx)("span",{children:"Saving.."})]}):N===s.task_id&&(0,H.jsx)(le,{itemValue:S,setIsAddingItem:O,setShowAddSub:w,selectedActivityId:N,setSelectedActivityId:_,setItemValue:k,refetch:d})}),null!==s.sub&&(0,H.jsx)("div",{className:"sub-list",children:null===(t=JSON.parse(s.sub))||void 0===t?void 0:t.map((e=>(0,H.jsxs)("div",{className:"sub-item",children:[(0,H.jsx)("button",{type:"button",onClick:()=>(async(e,s)=>{R(!0),A(s.task_id),T(e);const t=JSON.parse(s.sub).map((s=>s.id===e?{...s,status:"created"===s.status?"checked":"created"}:s));await ce.patch("api/task/".concat(s.task_id,"/activity/update-sub"),{sub:t}).then((()=>{d()})).catch((()=>(0,V.Z)("error","Something went wrong"))),T(),R(!1)})(e.id,s),disabled:e.employe_id!==ue,children:(0,H.jsxs)("div",{className:"item-title ".concat(D&&e.id===F&&s.task_id===z&&"checking"),children:[(0,H.jsxs)("div",{className:"title-check ".concat(D&&e.id!==F&&"not-allowed"),children:[D&&e.id===F&&s.task_id===z&&(0,H.jsx)(I.Z,{size:"sm",color:"primary"}),"checked"===e.status&&F!==e.id&&(0,H.jsx)(P(),{icon:"done"})]}),(0,H.jsx)("div",{className:"title-text",children:(0,H.jsxs)("span",{children:["checked"===e.status?(0,H.jsx)("s",{children:e.sub}):e.sub," "]})})]})}),(0,H.jsx)("div",{className:"item-action",children:e.employe_id===ue&&(0,H.jsx)("button",{type:"button",className:"delete",onClick:()=>(async(e,s)=>{U(!0),A(s.task_id),T(e);const t=JSON.parse(s.sub).filter((s=>s.id!==e));await ce.patch("api/task/".concat(s.task_id,"/activity/update-sub"),{sub:t}).then((()=>{d()})).catch((()=>(0,V.Z)("error","Something went wrong"))),U(!1)})(e.id,s),children:E&&e.id===F&&s.task_id===z?(0,H.jsx)(I.Z,{size:"sm",color:"danger"}):(0,H.jsx)(P(),{icon:"delete"})})})]},e.id)))})]},s.task_id)}))]},s.task_id)})),3!==parseInt(e.status,10)&&(0,H.jsx)("div",{className:"board-footer",children:(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)("div",{className:"d-flex gap-2",children:[(0,H.jsx)(P(),{icon:"event",style:{fontSize:"20px"}}),(0,H.jsx)("span",{className:"".concat((0,te.Z)(e.end_date)?"text-danger":""," "),style:{fontSize:"12px"},children:(0,G.Z)(e.end_date)})]}),(0,H.jsx)("div",{className:"members",children:(0,H.jsxs)("div",{className:"members-item",children:[null===e||void 0===e||null===(n=e.pics)||void 0===n?void 0:n.map(((e,s)=>s<2&&(0,H.jsxs)(l.Fragment,{children:[(0,H.jsx)("img",{id:"tooltip-".concat(e.id),src:L,className:"ava-pic rounded-circle",alt:"avatar",width:"35",height:"35"}),(0,H.jsx)(q.Z,{title:e.first_name,id:e.id.toString()})]},e.id))),(null===e||void 0===e||null===(c=e.pics)||void 0===c?void 0:c.length)>2&&(0,H.jsxs)("div",{className:"member-plus bg-light-info text-info fw-bold",children:["+",e.pics.length-2]})]})})]})})]},e.task_id)}))}),o&&(0,H.jsx)(X.Z,{modal:o,setModal:u,toggle:()=>{u(!o)},task:m,refetch:d,name:de})]})},re=["Manager"],ce=e=>{var s;let{directSupervisor:t,data:n,isLoading:a,error:d,refetch:r,isRefetching:c,isMemberActive:o}=e;const{auth:u}=(0,B.Z)(),[h,x]=(0,l.useState)(!1),{projectId:m}=(0,T.UO)();return(0,H.jsxs)(i.Z,{lg:"4",className:"mt-1",children:[(0,H.jsxs)("div",{className:"d-flex align-items-center justify-content-between bg-light-primary text-primary py-1 px-2 mb-2 rounded-3",children:[(0,H.jsx)("span",{className:"fw-bold",children:"To do"}),(0,H.jsx)("span",{className:"fw-bold",children:null===n||void 0===n?void 0:n.length})]}),a?"Loading...":d?"Something went wrong.":(0,H.jsxs)(H.Fragment,{children:[o&&(null===u||void 0===u||null===(s=u.user)||void 0===s?void 0:s.roles.find((e=>null===re||void 0===re?void 0:re.includes(e))))&&(h?(0,H.jsx)($,{projectId:m,setNewTaskOpen:x,refetch:r,type:1,title:"Create new goal.."}):(0,H.jsxs)(_.Z,{type:"button",size:"sm",color:"secondary",className:"d-flex align-items-center justify-content-center rounded-2",block:!0,onClick:()=>x(!0),children:[(0,H.jsx)(P(),{icon:"add",style:{fontSize:"14px"}}),"Add Goal"]})),(0,H.jsx)(de,{directSupervisor:t,data:n,projectId:m,refetch:r,isRefetching:c,isMemberActive:o})]})]})},oe=e=>{let{directSupervisor:s,data:t,isLoading:l,error:n,refetch:a,isRefetching:d,isMemberActive:r}=e;const{projectId:c}=(0,T.UO)();return(0,H.jsxs)(i.Z,{lg:"4",className:"mt-1",children:[(0,H.jsxs)("div",{className:"d-flex align-items-center justify-content-between bg-light-warning text-warning py-1 px-2 mb-2 rounded-3",children:[(0,H.jsx)("span",{className:"fw-bold",children:"In progress"}),(0,H.jsx)("span",{className:"fw-bold",children:null===t||void 0===t?void 0:t.length})]}),l?"Loading...":n?"Something went wrong.":(0,H.jsx)(H.Fragment,{children:(0,H.jsx)(de,{directSupervisor:s,data:t,projectId:c,refetch:a,isRefetching:d,isMemberActive:r})})]})},ue=e=>{let{data:s,isLoading:t,error:l,refetch:n,isRefetching:a}=e;const{projectId:d}=(0,T.UO)();return(0,H.jsxs)(i.Z,{lg:"4",className:"mt-1",children:[(0,H.jsxs)("div",{className:"d-flex align-items-center justify-content-between bg-light-success text-success py-1 px-2 mb-2 rounded-3",children:[(0,H.jsx)("span",{className:"fw-bold",children:"Done"}),(0,H.jsx)("span",{className:"fw-bold",children:null===s||void 0===s?void 0:s.length})]}),t?"Loading...":l?"Something went wrong.":(0,H.jsx)(H.Fragment,{children:(0,H.jsx)(de,{data:s,projectId:d,refetch:n,isRefetching:a})})]})},he=e=>null===e||void 0===e?void 0:e.filter(((s,t)=>(null===e||void 0===e?void 0:e.findIndex((e=>e.task_id===s.task_id)))===t)),xe=()=>{const{projectId:e}=(0,T.UO)(),[s,t]=(0,l.useState)([]),[r,c]=(0,l.useState)([]),[o,u]=(0,l.useState)([]),[h,x]=(0,l.useState)(""),[m,v]=(0,l.useState)(!1),j=(0,M.Z)(),{isLoading:p,error:g,data:f,refetch:b,isRefetching:y}=(0,A.a)({queryKey:["todos"],queryFn:()=>j.get("api/task/".concat(e,"/employe/list")).then((e=>(v(e.data.is_member_active),x(e.data.direct_supervisor.toString()),e.data.data)))});return(0,l.useEffect)((()=>{const e=null===f||void 0===f?void 0:f.filter((e=>0===parseInt(e.status,10)||4===parseInt(e.status,10))),s=null===f||void 0===f?void 0:f.filter((e=>1===parseInt(e.status,10))),l=null===f||void 0===f?void 0:f.filter((e=>2===parseInt(e.status,10)||3===parseInt(e.status,10)));t(e),c(he(s)),u(he(l))}),[f]),(0,l.useEffect)((()=>{b()}),[e]),(0,H.jsx)(d.Z,{children:p?(0,H.jsx)(i.Z,{children:(0,H.jsx)(n.Z,{children:(0,H.jsx)(a.Z,{className:"text-center",children:(0,H.jsx)("h6",{className:"tex-muted",children:"Loading..."})})})}):(0,H.jsx)(i.Z,{children:(0,H.jsxs)(d.Z,{children:[(0,H.jsx)(ce,{data:s,directSupervisor:h,isLoading:p,error:g,refetch:b,isRefetching:y,isMemberActive:m}),(0,H.jsx)(oe,{data:r,directSupervisor:h,isLoading:p,error:g,refetch:b,isRefetching:y,isMemberActive:m}),(0,H.jsx)(ue,{data:o,isLoading:p,error:g,refetch:b,isRefetching:y})]})})})},me=e=>{let{children:s}=e;return(0,H.jsx)("table",{className:"rounded-corners",children:s})},ve=()=>{const[e,s]=(0,l.useState)(),t=(0,M.Z)(),{projectId:d}=(0,T.UO)(),{isLoading:r,error:c,data:o,refetch:u}=(0,A.a)({queryKey:["members"],queryFn:()=>t.get("api/project/".concat(d,"/members")).then((e=>(s(e.data.count_task),e.data.data)))});return(0,l.useEffect)((()=>{u()}),[d]),(0,H.jsx)(i.Z,{children:(0,H.jsx)(n.Z,{className:"rounded-3",children:(0,H.jsx)(a.Z,{children:r?"Loading...":c?"Something went wrong.":(null===o||void 0===o?void 0:o.length)>0?(0,H.jsx)(me,{children:(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("thead",{children:(0,H.jsxs)("tr",{children:[(0,H.jsx)("th",{children:"#"}),(0,H.jsx)("th",{children:"Name"}),(0,H.jsx)("th",{children:"Position"}),(0,H.jsx)("th",{children:"Total Task"})]})}),(0,H.jsx)("tbody",{style:{overflow:"hidden"},children:null===o||void 0===o?void 0:o.map(((s,t)=>{return(0,H.jsxs)("tr",{children:[(0,H.jsx)("td",{children:t+1}),(0,H.jsx)("td",{children:s.first_name}),(0,H.jsx)("td",{children:s.position_name}),(0,H.jsx)("td",{children:e?(l=e,i=s.employe_id.toString(),l[i]):"-"})]},s.first_name);var l,i}))})]})}):(0,H.jsx)("div",{className:"d-flex justify-content-center",children:(0,H.jsx)("h6",{children:"No data yet."})})})})})};var je=t(28755);const pe=()=>{var e;const{projectId:s}=(0,T.UO)(),t=(0,M.Z)(),{isLoading:i,error:d,data:r,refetch:c}=(0,A.a)({queryKey:["files"],queryFn:()=>t.get("api/project/".concat(s,"/files")).then((e=>e.data.data))});return(0,l.useEffect)((()=>{c()}),[s]),(0,H.jsx)(n.Z,{className:"rounded-3",children:(0,H.jsx)(a.Z,{children:i?"Loading...":d?"Something went wrong.":(0,H.jsxs)(je.Z,{className:"no-wrap align-middle",hover:!0,style:{zIndex:"-1",fontSize:"13px"},children:[(0,H.jsx)("thead",{children:(0,H.jsxs)("tr",{children:[(0,H.jsx)("th",{width:"60",children:"#"}),(0,H.jsx)("th",{width:"700",children:"Filename"}),(0,H.jsx)("th",{children:"User"}),(0,H.jsx)("th",{width:"200",children:"Uploaded at"})]})}),null!==r&&void 0!==r&&r.length?(0,H.jsx)("tbody",{style:{overflow:"hidden"},children:null===(o=r,e=o.sort(((e,s)=>{let{created_at:t}=e,{created_at:l}=s;return t<l?-1:t>l?1:0})))||void 0===e?void 0:e.reverse().map(((e,s)=>(0,H.jsxs)("tr",{children:[(0,H.jsx)("td",{children:s+1}),(0,H.jsx)("td",{children:(0,H.jsx)(D.rU,{to:"".concat("https://api.ptpema.co.id/","taskfiles/").concat(e.file_name),target:"blank",children:e.file_name})}),(0,H.jsx)("td",{children:e.employee||"-"}),(0,H.jsx)("td",{children:(0,U.Z)(e.created_at)})]},e.file_id)))}):(0,H.jsx)("tbody",{style:{overflow:"hidden"},children:(0,H.jsx)("tr",{children:(0,H.jsx)("td",{colSpan:"4",className:"text-center",children:"No data yet."})})})]})})});var o};var ge=t(69399);const fe=e=>{let{setTotalReview:s}=e;const{projectId:t}=(0,T.UO)(),[d,c]=(0,l.useState)(!1),[o,u]=(0,l.useState)(""),[h,x]=(0,l.useState)(),[m,v]=(0,l.useState)(!1),[j,p]=(0,l.useState)(),[g,f]=(0,l.useState)(),b=(0,M.Z)(),[y,N]=(0,l.useState)([]),{isLoading:C,error:F,refetch:R,isRefetching:E}=(0,A.a)({queryKey:["review"],queryFn:()=>b.get("api/task/".concat(t,"/level1/review")).then((e=>(N(e.data.data),e.data.data)))}),L=()=>{c(!d)};(0,l.useEffect)((()=>{s(y.length)}),[y]),(0,l.useEffect)((()=>{R()}),[t]);const B=(e,s,t)=>{c(!0),u(e),x(s),f(t)};return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(i.Z,{children:C||E?(0,H.jsx)("div",{className:"d-flex justify-content-center",children:"Loading..."}):F?(0,H.jsxs)("div",{className:"d-flex justify-content-center",children:["Something went wrong ",(0,H.jsx)("span",{className:"material-icons",children:"sentiment_very_dissatisfied"})]}):y.map(((e,s)=>{var t,l;return(0,H.jsx)(n.Z,{className:"custom-card rounded-3",children:(0,H.jsxs)(a.Z,{children:[(0,H.jsxs)(r.Z,{tag:"h4",className:"d-flex justify-content-between",children:[(0,H.jsxs)("div",{className:"d-flex gap-2",children:[(0,H.jsxs)(Q.Z,{color:"light",className:"text-dark",children:["#",s+1]}),(0,H.jsx)(Q.Z,{color:"info",className:"",children:e.first_name})]}),(0,H.jsx)("span",{style:{fontSize:"14px"},children:(0,U.Z)(e.send_date)})]}),(0,H.jsx)("h5",{children:(0,H.jsx)("strong",{children:e.task_title})}),(0,H.jsx)("p",{children:e.task_desc}),(0,H.jsx)("span",{className:"text-dark",children:"Attachment:"}),(0,H.jsx)("div",{className:"",children:e.files.length>0?e.files.map(((e,s)=>(0,H.jsxs)("div",{className:"d-flex gap-3",children:[(0,H.jsxs)("span",{children:[s+1,"."]}),(0,H.jsx)(D.rU,{className:"file-link",to:"".concat("https://api.ptpema.co.id/","taskfiles/").concat(e.file_name),target:"blank",children:e.file_name})]},e.file_name))):"-"}),(0,H.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-4 border  py-2 px-3",style:{borderRadius:"10px"},children:[(0,H.jsxs)("div",{className:"d-flex gap-4",children:[(0,H.jsxs)("div",{color:"muted",children:[(0,H.jsx)("span",{className:"text-dark",children:"Start at: "}),(0,H.jsx)("br",{})," ",null===(t=(0,G.Z)(e.start_date))||void 0===t?void 0:t.split(",")[0]]}),(0,H.jsxs)("div",{color:"muted",children:[(0,H.jsx)("span",{className:"text-dark",children:"Due at: "}),(0,H.jsx)("br",{})," ",null===(l=(0,G.Z)(e.end_date))||void 0===l?void 0:l.split(",")[0]]})]}),(0,H.jsxs)("div",{className:"d-flex gap-2",children:[(0,H.jsx)(_.Z,{type:"button",size:"sm",color:"warning",outline:!0,onClick:()=>B("revision",e.task_id,e.employe_id),children:"Revision"}),(0,H.jsx)(_.Z,{type:"button",size:"sm",color:"success",onClick:()=>B("approve",e.task_id,e.employe_id),children:"Approve"})]})]})]})},e.approval_id)}))}),(0,H.jsxs)(Z.Z,{isOpen:d,toggle:L.bind(null),size:"md",fade:!1,centered:!0,children:[(0,H.jsx)(w.Z,{toggle:L.bind(null),children:"approve"===o?"Approval":"Revision"}),(0,H.jsxs)(ge.Z,{onSubmit:async e=>{e.preventDefault(),v(!0),await b.put("api/task/".concat(h,"/status"),{employe_id:g,status:"approve"===o?3:4,note:j}).then((()=>{(0,V.Z)("success","Task has been ".concat("approve"===o?"approved":"reviewed"))})).catch((e=>console.log(e))),R(),c(!1),v(!1)},children:[(0,H.jsx)(S.Z,{children:(0,H.jsx)(k.Z,{children:(0,H.jsx)(O.Z,{type:"textarea",id:"goals",name:"goals",placeholder:"Comment here..",rows:"3",required:!0,onChange:e=>p(e.target.value)})})}),(0,H.jsxs)(z.Z,{children:[(0,H.jsx)(_.Z,{color:"secondary",outline:!0,onClick:L.bind(null),children:"Cancel"}),(0,H.jsx)(_.Z,{type:"submit",color:"".concat("approve"===o?"success":"warning"),disabled:m,className:"d-flex gap-1 align-items-center",children:m?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(I.Z,{className:"me-2",size:"sm"}),"Sending..."]}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(P(),{icon:"send",style:{fontSize:"20px"}}),"approve"===o?"Approve":"Send"]})})]})]})]})]})},be=()=>{var e,s;const[t,c]=(0,l.useState)(!1),[o,u]=(0,l.useState)(!1),[h,x]=(0,l.useState)({}),{auth:m}=(0,B.Z)(),{projectId:v}=(0,T.UO)(),j=(0,M.Z)(),p=()=>{c(!t)},{isLoading:g,error:f,data:b,refetch:y,isRefetching:N}=(0,A.a)({queryKey:["handover"],queryFn:()=>j.get("api/project/".concat(null===m||void 0===m?void 0:m.user.employe_id,"/").concat(v,"/handover")).then((e=>e.data.data))}),F=e=>{x((s=>({...s,[e.target.name]:e.target.value})))};return(0,l.useEffect)((()=>{y()}),[v]),(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(i.Z,{children:g||N?(0,H.jsx)("div",{className:"d-flex justify-content-center",children:"Loading..."}):f?(0,H.jsxs)("div",{className:"d-flex justify-content-center",children:["Something went wrong ",(0,H.jsx)("span",{className:"material-icons",children:"sentiment_very_dissatisfied"})]}):null!==b&&(0,H.jsx)(n.Z,{className:"custom-card",children:(0,H.jsxs)(a.Z,{children:[(0,H.jsxs)(r.Z,{tag:"h4",className:"d-flex justify-content-between",children:[(0,H.jsx)("div",{className:"d-flex gap-2",children:(0,H.jsx)(Q.Z,{color:"light",className:"text-dark",children:"Handover project"})}),(0,H.jsx)("span",{style:{fontSize:"14px"},children:(0,U.Z)(b.created_at)})]}),(0,H.jsx)("div",{className:"d-flex  justify-content-center",children:(0,H.jsxs)("h5",{children:["Handover of the project from ",(0,H.jsx)("strong",{children:b.from_division})," to"," ",(0,H.jsx)("strong",{children:b.to_division})]})}),(0,H.jsx)("p",{}),(0,H.jsx)("span",{className:"text-dark",children:"BAST File:"}),(0,H.jsx)("div",{className:"",children:(0,H.jsx)("div",{className:"d-flex gap-3",children:(0,H.jsx)(D.rU,{className:"file-link",to:"".concat("https://api.ptpema.co.id/","project/").concat(b.file),target:"blank",children:b.file})})}),(0,H.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-4 border  py-2 px-3",style:{borderRadius:"10px"},children:[(0,H.jsx)("div",{className:"d-flex gap-4",children:(0,H.jsxs)("div",{className:"d-flex gap-3 align-items-center",children:[(0,H.jsx)("img",{src:L,className:"rounded-circle",alt:"avatar",width:"45",height:"45"}),(0,H.jsxs)("div",{className:"d-flex flex-column",children:[(0,H.jsx)("span",{className:"text-dark fw-bold",children:b.old_pic}),(0,H.jsx)("small",{className:"text-muted",children:b.from_division})]})]})}),(0,H.jsx)("div",{className:"d-flex gap-2",children:(0,H.jsx)(_.Z,{type:"button",size:"md",color:"success",outline:!0,onClick:p.bind(null),children:"Confirm"})})]})]})})}),(0,H.jsxs)(Z.Z,{isOpen:t,toggle:p.bind(null),size:"md",fade:!1,centered:!0,children:[(0,H.jsx)(w.Z,{toggle:p.bind(null),children:"Confirmation"}),(0,H.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),u(!0),j.post("api/project/".concat(null===b||void 0===b?void 0:b.history_id,"/confirm"),h).then((e=>{y(),(0,V.Z)("success",e.data.message)})).catch((e=>{(0,V.Z)("error",e.response.data.error)})),c(!1),u(!1)},children:[(0,H.jsxs)(S.Z,{children:[(0,H.jsx)("div",{className:"d-flex justify-content-center",children:(0,H.jsxs)("h6",{className:"fw-bold",children:["Next stage:"," ",1===(null===b||void 0===b||null===(e=b.current_stage)||void 0===e?void 0:e.phase)?"Planning":2===(null===b||void 0===b||null===(s=b.current_stage)||void 0===s?void 0:s.phase)?"Execution, Control & Monitoring":""]})}),(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{htmlFor:"desc_stage",children:"Description"}),(0,H.jsx)(O.Z,{type:"textarea",name:"desc_stage",id:"desc_stage",placeholder:"stage description here..",rows:"3",onChange:F})]}),(0,H.jsxs)(d.Z,{children:[(0,H.jsx)(i.Z,{md:"6",children:(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{for:"start_date",children:"Start date"}),(0,H.jsx)(O.Z,{type:"date",id:"start_date",name:"start_date",onChange:F})]})}),(0,H.jsx)(i.Z,{md:"6",children:(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{for:"end_date",children:"End date"}),(0,H.jsx)(O.Z,{type:"date",id:"end_date",name:"end_date",onChange:F})]})})]})]}),(0,H.jsxs)(z.Z,{children:[(0,H.jsx)(_.Z,{color:"secondary",outline:!0,onClick:p.bind(null),children:"Cancel"}),(0,H.jsx)(_.Z,{type:"submit",color:"success",disabled:o,className:"d-flex gap-1 align-items-center",children:o?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(I.Z,{className:"me-2",size:"sm",color:"light"}),"Sending"]}):"Send"})]})]})]})]})};var ye=t(46272),Ne=t(79617),_e=t(20890),Ze=t(14097);t(42459);const we=e=>{const s=null===e||void 0===e?void 0:e.level_3;let t=0,l=0;if((null===s||void 0===s?void 0:s.length)>0){for(let e=0;e<(null===s||void 0===s?void 0:s.length);e++)t+=s[e].task_progress;l=t/s.length}else l=null===e||void 0===e?void 0:e.task_progress;return l},Se=e=>{const s=null===e||void 0===e?void 0:e.level_2;let t=0,l=0;if((null===s||void 0===s?void 0:s.length)>0){for(let e=0;e<s.length;e++)t+=we(s[e]);l=t/s.length}else l=null===e||void 0===e?void 0:e.task_progress;return l},ke=()=>{const{auth:e}=(0,B.Z)(),{projectId:s}=(0,T.UO)(),[t,r]=(0,l.useState)(!1),[c,o]=(0,l.useState)(void 0),[u,h]=(0,l.useState)(),[x,m]=(0,l.useState)(),[v,j]=(0,l.useState)(!1),[p,g]=(0,l.useState)(),[f,b]=(0,l.useState)(),[y,Z]=(0,l.useState)(0),w=(0,M.Z)(),{search:S}=(0,T.TH)(),{isLoading:k,error:C,data:z,refetch:F}=(0,A.a)({queryKey:["act"],queryFn:()=>w.get("api/task/".concat(s,"/activities/all").concat(S)).then((e=>(g(e.data.project),e.data.data)))});(0,l.useEffect)((()=>{b(z),async function(){await w.post("api/project/progress/collection",{ids:[s]}).then((e=>{var s;Z(null===(s=e.data.data[0])||void 0===s?void 0:s.progress)})).catch((e=>console.log(e)))}()}),[z]);const R=e=>{r(!0),o(e)},E=async s=>{h(s),m(!0),await w.post("api/task/".concat(null===e||void 0===e?void 0:e.user.employe_id,"/").concat(s,"/favorite")).then((e=>{F(),(0,V.Z)("success",e.data.message)})).catch((()=>{(0,V.Z)("error","Something went wrong.")})),h(),m(!1)},U=["Director"],W=["Manager"];(0,l.useEffect)((()=>{null!==e&&void 0!==e&&e.user.roles.find((e=>U.includes(e)))&&j(!0)}),[e]);const[J,K]=l.useState(null),Y=Boolean(J),$=Y?"simple-popover":void 0;return(0,l.useEffect)((()=>{F()}),[s]),(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(i.Z,{children:(0,H.jsx)(n.Z,{className:"rounded-3",children:(0,H.jsx)(a.Z,{children:k?"loading...":C?"Something went wrong.":(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)(d.Z,{children:[(0,H.jsx)(i.Z,{sm:"12 mb-2",md:"6",children:(0,H.jsxs)("div",{className:"d-flex gap-2",children:[(0,H.jsxs)(_.Z,{type:"button",className:"d-flex align-items-center gap-2 rounded-3",color:"light",size:"sm",children:[(0,H.jsx)(P(),{icon:"filter_list",style:{fontSize:"12px"}}),"Sort"]}),(0,H.jsxs)(_.Z,{type:"button",className:"d-flex align-items-center gap-2 rounded-3",color:"light",size:"sm",children:[(0,H.jsx)(P(),{icon:"tune",style:{fontSize:"12px"}}),"Filters"]})]})}),(0,H.jsx)(i.Z,{sm:"12",md:"6",children:(0,H.jsxs)("div",{className:"d-flex gap-3 col-md-6 w-100",children:[(0,H.jsxs)("div",{className:"w-100 position-relative",children:[(0,H.jsx)(O.Z,{type:"text",className:"rounded-3",bsSize:"md",placeholder:"Search task...",onChange:e=>(e=>{const s=z.filter((s=>s.task_title.toLowerCase().includes(e.toLowerCase())));b(s)})(e.target.value)}),(0,H.jsxs)("div",{className:"position-absolute top-0 end-0 h-100 p-1",children:[(0,H.jsx)(_.Z,{type:"button",className:"btn btn-light w-100 h-100 border-0 rounded-3 text-muted","aria-describedby":$,variant:"contained",onClick:e=>{K(e.currentTarget)},children:(0,H.jsx)(P(),{icon:"more_horiz",style:{fontSize:"16px"}})}),(0,H.jsx)(Ne.ZP,{id:$,open:Y,anchorEl:J,onClick:()=>{K(null)},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,H.jsx)(_e.Z,{sx:{p:2},children:(0,H.jsxs)(i.Z,{children:[(0,H.jsx)(d.Z,{children:(0,H.jsx)(D.rU,{to:"#",children:"Task"})}),(0,H.jsx)(d.Z,{children:(0,H.jsx)(D.rU,{to:"#",children:"Employee"})}),(0,H.jsx)(d.Z,{children:(0,H.jsx)(D.rU,{to:"#",children:"Date"})})]})})})]})]}),(null===e||void 0===e?void 0:e.user.roles.find((e=>W.includes(e))))&&(0,H.jsx)(ye.WD,{document:(0,H.jsx)(Ze.Z,{projectTitle:p,data:z}),fileName:"Task Report - ".concat(null===p||void 0===p?void 0:p.project_number," - ").concat(null===p||void 0===p?void 0:p.division),style:{textDecoration:"none"},children:(0,H.jsx)(_.Z,{type:"button",className:"btn btn-light-info text-info rounded-3 d-flex py-2",children:(0,H.jsx)(P(),{icon:"file_download",style:{fontSize:"18px"}})})})]})})]}),(0,H.jsxs)(i.Z,{sm:"12 overflow-auto",children:[(0,H.jsxs)("div",{className:"d-flex align-items-center justify-content-between mt-2",children:[(0,H.jsxs)("h6",{className:"fw-bold",children:["List of tasks from ",null===p||void 0===p?void 0:p.division]}),(0,H.jsx)("div",{className:"w-25",children:(0,H.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,H.jsx)("div",{style:{width:"86%"},children:(0,H.jsx)(N,{className:"",color:"success",value:y.toFixed(),style:{height:"12px"}})}),(0,H.jsxs)("span",{className:"fw-bold",children:[y.toFixed(),"%"]})]})})]}),(0,H.jsxs)("table",{className:"rounded-corners act-table",children:[(0,H.jsx)("thead",{children:(0,H.jsxs)("tr",{children:[(0,H.jsx)("th",{width:"30",children:"#"}),(0,H.jsx)("th",{colSpan:"3",style:{minWidth:"400px"},children:"Task title"}),(0,H.jsx)("th",{width:"",children:"Status"}),(0,H.jsx)("th",{style:{minWidth:"100px"},children:"Start date"}),(0,H.jsx)("th",{style:{minWidth:"100px"},children:"Due date"}),(0,H.jsx)("th",{children:"Progress"}),(0,H.jsx)("th",{width:"100",children:"PIC"}),v&&(0,H.jsx)("th",{width:"50"})]})}),(0,H.jsx)("tbody",{children:(null===f||void 0===f?void 0:f.length)>0?null===f||void 0===f?void 0:f.map(((e,s)=>{var t,i,n,a,d,r;return(0,H.jsxs)(l.Fragment,{children:[(0,H.jsxs)("tr",{children:[(0,H.jsxs)("td",{children:[s+1,"."]}),(0,H.jsxs)("td",{colSpan:"3",style:{cursor:"pointer"},onClick:()=>R(e),children:[(0,H.jsx)("span",{style:{fontWeight:"600"},children:e.task_title}),(0,H.jsx)("br",{}),(0,H.jsxs)(Q.Z,{color:"light",className:"text-muted",children:[null===e||void 0===e||null===(t=e.level_2)||void 0===t?void 0:t.length," subtask"]}),"  ",(0,H.jsxs)(Q.Z,{color:"light",className:"text-muted",children:[(0,H.jsx)(P(),{icon:"comment",style:{fontSize:"12px"}}),e.comments]})]}),(0,H.jsx)("td",{children:0===e.status?(0,H.jsx)(Q.Z,{color:"light",className:"text-dark",children:"To Do"}):1===e.status?(0,H.jsx)(Q.Z,{color:"warning",children:"In Progress"}):2===e.status?(0,H.jsx)(Q.Z,{color:"light",className:"text-dark",children:"Under Review"}):3===e.status?(0,H.jsx)(Q.Z,{color:"success",children:"Approved"}):(0,H.jsx)(Q.Z,{color:"danger",children:"Revision"})}),(0,H.jsx)("td",{children:(0,G.Z)(e.start_date)}),(0,H.jsx)("td",{className:"".concat((0,te.Z)(e.end_date)?"text-danger":""),children:(0,G.Z)(e.end_date)}),(0,H.jsx)("td",{children:(0,H.jsxs)("span",{className:"badge bg-light-success text-primary rounded-pill d-inline-block fw-bold",children:[null===(i=Se(e))||void 0===i?void 0:i.toFixed(),"%"]})}),(0,H.jsx)("td",{children:(0,H.jsx)("div",{className:"members",children:(0,H.jsxs)("div",{className:"members-item",children:[null===e||void 0===e||null===(n=e.pics)||void 0===n?void 0:n.map(((e,s)=>{var t;return s<2&&(0,H.jsxs)(l.Fragment,{children:[(0,H.jsx)("img",{id:"tooltip-".concat(e.id),src:L,className:"ava-pic rounded-circle",alt:"avatar",width:"35",height:"35"}),(0,H.jsx)(q.Z,{title:e.first_name,id:null===(t=e.id)||void 0===t?void 0:t.toString()})]},e.id)})),(null===e||void 0===e||null===(a=e.pics)||void 0===a?void 0:a.length)>2&&(0,H.jsxs)("div",{className:"member-plus bg-light-info text-info fw-bold",children:["+",e.pics.length-2]})]})})}),v&&(0,H.jsx)("td",{className:"text-center",children:x&&u===e.task_id?(0,H.jsx)(I.Z,{size:"sm",color:"warning"}):(0,H.jsx)("abbr",{title:"Mark task",style:{textDecoration:"none"},children:(0,H.jsx)("button",{type:"button",className:"fav-btn",onClick:()=>E(e.task_id),children:(0,H.jsx)(P(),{icon:"star",className:"".concat(e.isFavorite&&"is_favorite")})})})})]}),(null===(d=e.level_2)||void 0===d?void 0:d.length)>0&&(null===(r=e.level_2)||void 0===r?void 0:r.map(((e,t)=>{var i,n,a,d,r,c;return(0,H.jsxs)(l.Fragment,{children:[(0,H.jsxs)("tr",{children:[(0,H.jsx)("td",{}),(0,H.jsxs)("td",{width:"5",children:[s+1,".",t+1]}),(0,H.jsxs)("td",{colSpan:"2",onClick:()=>R(e),style:{cursor:"pointer",textAlign:"left",fontWeight:"500"},children:[e.task_title,(0,H.jsx)("br",{}),(0,H.jsxs)(Q.Z,{color:"light",className:"text-muted",children:[null===e||void 0===e||null===(i=e.level_3)||void 0===i?void 0:i.length," subtask"]}),"  ",(0,H.jsxs)(Q.Z,{color:"light",className:"text-muted",children:[(0,H.jsx)(P(),{icon:"comment",style:{fontSize:"12px"}}),e.comments]})]}),(0,H.jsx)("td",{children:"-"}),(0,H.jsx)("td",{children:(0,G.Z)(e.start_date)}),(0,H.jsx)("td",{className:"".concat((0,te.Z)(e.end_date)?"text-danger":""),children:(0,G.Z)(e.end_date)}),(0,H.jsx)("td",{children:(0,H.jsxs)("span",{className:"badge bg-light-primary text-primary rounded-pill d-inline-block fw-bold",children:[null===(n=we(e))||void 0===n?void 0:n.toFixed(),"%"]})}),(0,H.jsx)("td",{children:(0,H.jsx)("div",{className:"members",children:(0,H.jsxs)("div",{className:"members-item",children:[null===e||void 0===e||null===(a=e.pics)||void 0===a?void 0:a.map(((e,s)=>{var t;return s<2&&(0,H.jsxs)(l.Fragment,{children:[(0,H.jsx)("img",{id:"tooltip-".concat(e.id),src:L,className:"ava-pic rounded-circle",alt:"avatar",width:"35",height:"35"}),(0,H.jsx)(q.Z,{title:e.first_name,id:null===(t=e.id)||void 0===t?void 0:t.toString()})]},e.id)})),(null===e||void 0===e||null===(d=e.pics)||void 0===d?void 0:d.length)>2&&(0,H.jsxs)("div",{className:"member-plus bg-light-info text-info fw-bold",children:["+",e.pics.length-2]})]})})}),v&&(0,H.jsx)("td",{className:"text-center",children:x&&u===e.task_id?(0,H.jsx)(I.Z,{size:"sm",color:"warning"}):(0,H.jsx)("abbr",{title:"Mark task",style:{textDecoration:"none"},children:(0,H.jsx)("button",{type:"button",className:"fav-btn",onClick:()=>E(e.task_id),children:(0,H.jsx)(P(),{icon:"star",className:"".concat(e.isFavorite&&"is_favorite")})})})})]},e.task_id),(null===(r=e.level_3)||void 0===r?void 0:r.length)>0&&(null===(c=e.level_3)||void 0===c?void 0:c.map(((e,i)=>{var n,a,d;return(0,H.jsxs)("tr",{children:[(0,H.jsx)("td",{}),(0,H.jsx)("td",{}),(0,H.jsxs)("td",{width:"5",children:[s+1,".",t+1,".",i+1]}),(0,H.jsxs)("td",{onClick:()=>R(e),style:{cursor:"pointer",textAlign:"left"},children:[e.task_title,(0,H.jsx)("br",{}),(0,H.jsxs)(Q.Z,{color:"light",className:"text-muted",children:[(0,H.jsx)(P(),{icon:"comment",style:{fontSize:"12px"}}),e.comments]})]}),(0,H.jsx)("td",{children:"-"}),(0,H.jsx)("td",{children:(0,G.Z)(e.start_date)}),(0,H.jsx)("td",{className:"".concat((0,te.Z)(e.end_date)?"text-danger":""),children:(0,G.Z)(e.end_date)}),(0,H.jsx)("td",{children:(0,H.jsxs)("span",{className:"badge bg-light-primary text-primary rounded-pill d-inline-block fw-bold",children:[null===e||void 0===e||null===(n=e.task_progress)||void 0===n?void 0:n.toFixed(),"%"]})}),(0,H.jsx)("td",{children:(0,H.jsx)("div",{className:"members",children:(0,H.jsxs)("div",{className:"members-item",children:[null===e||void 0===e||null===(a=e.pics)||void 0===a?void 0:a.map(((e,s)=>{var t;return s<2&&(0,H.jsxs)(l.Fragment,{children:[(0,H.jsx)("img",{id:"tooltip-".concat(e.id),src:L,className:"ava-pic rounded-circle",alt:"avatar",width:"35",height:"35"}),(0,H.jsx)(q.Z,{title:e.first_name,id:null===(t=e.id)||void 0===t?void 0:t.toString()})]},e.id)})),(null===e||void 0===e||null===(d=e.pics)||void 0===d?void 0:d.length)>2&&(0,H.jsxs)("div",{className:"member-plus bg-light-info text-info fw-bold",children:["+",e.pics.length-2]})]})})}),v&&(0,H.jsx)("td",{className:"text-center",children:x&&u===e.task_id?(0,H.jsx)(I.Z,{size:"sm",color:"warning"}):(0,H.jsx)("abbr",{title:"Mark task",style:{textDecoration:"none"},children:(0,H.jsx)("button",{type:"button",className:"fav-btn",onClick:()=>E(e.task_id),children:(0,H.jsx)(P(),{icon:"star",className:"".concat(e.isFavorite&&"is_favorite")})})})})]},e.task_id)})))]},e.task_id)})))]},e.task_id)})):(0,H.jsx)("tr",{children:(0,H.jsx)("td",{colSpan:"9",align:"center",children:"No data available"})})})]})]})]})})})}),t&&(0,H.jsx)(X.Z,{modal:t,setModal:r,toggle:()=>{r(!t)},task:c,mode:"activities"})]})},Ce=e=>{let{setTotalBastReview:s}=e;const{auth:t}=(0,B.Z)(),{projectId:d}=(0,T.UO)(),[c,o]=(0,l.useState)(!1),[u,h]=(0,l.useState)(""),[x,m]=(0,l.useState)(),[v,j]=(0,l.useState)(),[p,g]=(0,l.useState)(),[f,b]=(0,l.useState)(),[y,N]=(0,l.useState)(!1),C=(0,M.Z)(),{isLoading:F,error:R,data:E,refetch:q}=(0,A.a)({queryKey:["bast-review"],queryFn:()=>C.get("api/project/".concat(d,"/").concat(null===t||void 0===t?void 0:t.user.employe_id,"/bast/review")).then((e=>e.data.data))});(0,l.useEffect)((()=>{s(10)}),[E]);const G=(e,s,t,l)=>{o(!0),h(e),j(s||null),g(t),b(l)},W=()=>{o(!c)};return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(i.Z,{children:F?(0,H.jsx)(n.Z,{children:(0,H.jsx)(a.Z,{children:"Loading..."})}):R?"Something went wrong.":(0,H.jsx)(n.Z,{className:"custom-card",children:E&&(0,H.jsxs)(a.Z,{children:[(0,H.jsxs)(r.Z,{tag:"h4",className:"d-flex justify-content-between",children:[(0,H.jsx)("div",{className:"d-flex gap-2",children:(0,H.jsx)(Q.Z,{color:"light",className:"text-dark",children:"Review BAST"})}),(0,H.jsx)("span",{style:{fontSize:"14px"},children:(0,U.Z)(E.created_at)})]}),(0,H.jsx)("div",{className:"d-flex  justify-content-center",children:(0,H.jsxs)("h5",{children:["Handover of the project from ",(0,H.jsx)("strong",{children:E.old_pic_division})," to"," ",(0,H.jsx)("strong",{children:E.new_pic_division})]})}),(0,H.jsx)("span",{className:"text-dark",children:"BAST file:"}),(0,H.jsx)("div",{className:"",children:(0,H.jsx)("div",{className:"d-flex gap-3",children:(0,H.jsx)(D.rU,{className:"file-link",to:"",target:"blank",children:E.file})})}),(0,H.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-4 border  py-2 px-3",style:{borderRadius:"10px"},children:[(0,H.jsx)("div",{className:"d-flex gap-4",children:(0,H.jsxs)("div",{className:"d-flex gap-3 align-items-center",children:[(0,H.jsx)("img",{src:L,className:"rounded-circle",alt:"avatar",width:"45",height:"45"}),(0,H.jsxs)("div",{className:"d-flex flex-column",children:[(0,H.jsx)("span",{className:"text-dark fw-bold",children:E.old_pic}),(0,H.jsx)("small",{className:"text-muted",children:E.old_pic_division})]})]})}),(0,H.jsxs)("div",{className:"d-flex gap-2",children:[(0,H.jsx)(_.Z,{type:"button",size:"md",color:"warning",outline:!0,onClick:()=>G("revision",E.old_pic_id,E.review_by),children:"Revision"}),(0,H.jsx)(_.Z,{type:"button",size:"md",color:"success",onClick:()=>G("approve",E.old_pic_id,E.new_pic_id,E.review_by),children:"Approve"})]})]})]})})}),(0,H.jsxs)(Z.Z,{isOpen:c,toggle:W.bind(null),size:"md",fade:!1,centered:!0,children:[(0,H.jsx)(w.Z,{toggle:W.bind(null),children:"approve"===u?"Approval":"Revision"}),(0,H.jsxs)(ge.Z,{onSubmit:async e=>{e.preventDefault(),N(!0),await C.post("api/project/".concat(null===E||void 0===E?void 0:E.history_id,"/bast/approval"),{project_id:d,old_pic:v,notif_to:p,review_by:f,status:"approve"===u?"handover":"revision",note:x}).then((()=>{q(),(0,V.Z)("success","BAST has been ".concat("approve"===u?"approved":"reviewed"))})).catch((e=>console.log(e))),o(!1),N(!1)},children:[(0,H.jsx)(S.Z,{children:(0,H.jsx)(k.Z,{children:(0,H.jsx)(O.Z,{type:"textarea",id:"goals",name:"goals",placeholder:"Comment here..",rows:"3",required:!0,onChange:e=>m(e.target.value)})})}),(0,H.jsxs)(z.Z,{children:[(0,H.jsx)(_.Z,{color:"secondary",outline:!0,onClick:W.bind(null),children:"Cancel"}),(0,H.jsx)(_.Z,{type:"submit",color:"".concat("approve"===u?"success":"warning"),disabled:y,className:"d-flex gap-1 align-items-center",children:y?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(I.Z,{className:"me-2",size:"sm"}),"Sending..."]}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(P(),{icon:"send",style:{fontSize:"20px"}}),"approve"===u?"Approve":"Send"]})})]})]})]})]})},Oe=e=>{let{navActive:s,setTotalReview:t,setTotalBastReview:l,roles:i}=e;return(0,H.jsxs)(H.Fragment,{children:[1===s&&(0,H.jsx)(Y,{}),!i.includes("Director")&&2===s&&(0,H.jsx)(xe,{}),3===s&&(0,H.jsx)(ve,{}),4===s&&(0,H.jsx)(pe,{}),5===s&&(0,H.jsx)(fe,{setTotalReview:t}),!i.includes("Director")&&6===s&&(0,H.jsx)(be,{}),7===s&&(0,H.jsx)(ke,{}),8===s&&(0,H.jsx)(Ce,{setTotalBastReview:l})]})};t(35754);var ze=t(97925),Ie=t(8453),Ae=t(71971);const Fe=e=>{var s,t,n,a,r,c;let{modal:o,setModal:u,toggle:h,data:x,refetch:m}=e;const[v,j]=(0,l.useState)({}),[p,g]=(0,l.useState)({}),[f,b]=(0,l.useState)({}),[y,N]=(0,l.useState)([]),[A,F]=(0,l.useState)({}),[P,T]=(0,l.useState)(!1),[D,L]=(0,l.useState)(!1),[U,B]=(0,l.useState)(!1),[q,G]=(0,l.useState)(),[W,J]=(0,l.useState)({}),[K,Y]=(0,l.useState)({}),[Q,X]=(0,l.useState)(),[$,ee]=(0,l.useState)(!1),se=(0,E.ZP)(),te=(0,M.Z)();(0,l.useEffect)((()=>{var e,s,t,l,i,n;j(x),g({project_number:null===x||void 0===x?void 0:x.project_number,project_name:null===x||void 0===x?void 0:x.project_name,goals:null===x||void 0===x?void 0:x.goals,estimated_income:null===x||void 0===x?void 0:x.estimated_income,estimated_cost:null===x||void 0===x?void 0:x.estimated_cost,base_id:null===x||void 0===x?void 0:x.base_id,level_id:null===x||void 0===x?void 0:x.level_id,business_id:null===x||void 0===x?void 0:x.business_id,category:null===x||void 0===x?void 0:x.category,start_date:null===x||void 0===x||null===(e=x.current_stage)||void 0===e?void 0:e.start_date,end_date:null===x||void 0===x||null===(s=x.current_stage)||void 0===s?void 0:s.end_date,desc:null===x||void 0===x||null===(t=x.current_stage)||void 0===t?void 0:t.desc,partner:null===x||void 0===x||null===(l=x.current_stage)||void 0===l?void 0:l.partner_id}),X({value:null===x||void 0===x?void 0:x.business_id,label:null===x||void 0===x?void 0:x.business_desc}),Y({value:null===x||void 0===x||null===(i=x.current_stage)||void 0===i?void 0:i.partner_name,label:null===x||void 0===x||null===(n=x.current_stage)||void 0===n?void 0:n.partner_name})}),[x]);const le=async()=>{await te.get("api/project/business/options").then((e=>b(e.data))).catch((e=>console.log(e)))};(0,l.useEffect)((()=>{le(),async function(){await te.get("api/list-mitra").then((e=>N(e.data.data))).catch((e=>console.log(e)))}()}),[]),(0,l.useEffect)((()=>{y.unshift({label:"TAMBAH LAINNYA",value:"LAINNYA"})}),[y]),(0,l.useEffect)((()=>{"LAINNYA"===(null===A||void 0===A?void 0:A.value)&&(ee(!0),F({}))}),[A]);const ie=e=>{g((s=>({...s,[e.target.name]:e.target.value})))};(0,l.useEffect)((()=>{"another"===(null===p||void 0===p?void 0:p.base_id)&&L(!0)}),[p]);return(0,H.jsx)(H.Fragment,{children:(0,H.jsxs)(Z.Z,{isOpen:o,toggle:h.bind(null),size:"lg",fade:!1,children:[(0,H.jsx)(w.Z,{toggle:h.bind(null),children:"Update Project"}),(0,H.jsxs)(ge.Z,{onSubmit:async e=>{var s,t,l,i;e.preventDefault(),T(!0),p.stage_id=null===v||void 0===v||null===(s=v.current_stage)||void 0===s?void 0:s.stage_id,p.partner=0!==(null===(t=Object.keys(A))||void 0===t?void 0:t.length)?A.value:null!==p&&void 0!==p&&p.partner?null===p||void 0===p?void 0:p.partner:null===x||void 0===x||null===(l=x.current_stage)||void 0===l?void 0:l.partner_name,p.business_id=0!==(null===(i=Object.keys(W))||void 0===i?void 0:i.length)?W.value:null===x||void 0===x?void 0:x.business_id,await te.patch("api/project/".concat(null===v||void 0===v?void 0:v.project_id,"/update"),p).then((()=>{m(),(0,V.Z)("success","Project has been updated.")})).catch((()=>{(0,V.Z)("error","Something went wrong.")})),ee(!1),T(!1),u(!1)},children:[(0,H.jsxs)(S.Z,{children:[(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{htmlFor:"project_number",children:"Project Number"}),(0,H.jsx)(O.Z,{type:"text",name:"project_number",id:"project_number",placeholder:"Project number here",onChange:ie,defaultValue:(null===v||void 0===v?void 0:v.project_number)||""})]}),(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{htmlFor:"project_name",children:"Project name"}),(0,H.jsx)(O.Z,{type:"text",name:"project_name",id:"project_name",placeholder:"Project name here",onChange:ie,defaultValue:null===v||void 0===v?void 0:v.project_name})]}),(0,H.jsxs)(d.Z,{children:[(0,H.jsx)(i.Z,{md:"6",children:(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{for:"start_date",children:"Start date"}),(0,H.jsx)(O.Z,{type:"date",id:"start_date",name:"start_date",onChange:ie,defaultValue:(null===v||void 0===v||null===(s=v.current_stage)||void 0===s?void 0:s.start_date)||""})]})}),(0,H.jsx)(i.Z,{md:"6",children:(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{for:"end_date",children:"End date"}),(0,H.jsx)(O.Z,{type:"date",id:"end_date",name:"end_date",onChange:ie,defaultValue:(null===v||void 0===v||null===(t=v.current_stage)||void 0===t?void 0:t.end_date)||""})]})})]}),(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{htmlFor:"goals",children:"Goals"}),(0,H.jsx)(O.Z,{type:"textarea",id:"goals",name:"goals",placeholder:"Explain the goals of the project here",rows:"3",onChange:ie,defaultValue:(null===v||void 0===v?void 0:v.goals)||""})]}),(0,H.jsxs)(d.Z,{children:[(0,H.jsx)(i.Z,{md:"6",children:(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{for:"level_id",children:"Activity level"}),(0,H.jsxs)(O.Z,{type:"select",id:"level_id",name:"level_id",onChange:ie,defaultValue:(null===v||void 0===v?void 0:v.level_id)||"",children:[(0,H.jsx)("option",{disabled:!0,value:"al",children:"- Select -"}),null===f||void 0===f||null===(n=f.activity_level)||void 0===n?void 0:n.map((e=>(0,H.jsx)("option",{value:e.level_id,children:e.level_desc},e.level_id)))]})]})}),(0,H.jsx)(i.Z,{md:"6",children:(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{for:"category",children:"Category"}),(0,H.jsxs)(O.Z,{type:"select",id:"category",name:"category",onChange:ie,defaultValue:(null===v||void 0===v?void 0:v.category)||"",children:[(0,H.jsx)("option",{disabled:!0,value:"cat",children:"- Select -"}),(0,H.jsx)("option",{value:"business",children:"Business"}),(0,H.jsx)("option",{value:"non-business",children:"Non-business"})]})]})})]}),("business"===(null===v||void 0===v?void 0:v.category)||"business"===(null===p||void 0===p?void 0:p.category))&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{for:"partner",children:"Partner"}),$?(0,H.jsx)(O.Z,{type:"text",name:"partner",id:"partner",placeholder:"Type here..",onChange:ie}):(0,H.jsx)(R.ZP,{components:se,options:y,defaultValue:K,onChange:e=>F(e)})]}),(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{htmlFor:"desc",children:"Description for Initiation & Definition phase"}),(0,H.jsx)(O.Z,{type:"textarea",id:"desc",name:"desc",placeholder:"Description of the phase here",rows:"3",onChange:ie,defaultValue:null===v||void 0===v||null===(a=v.current_stage)||void 0===a?void 0:a.desc})]}),(0,H.jsxs)(d.Z,{children:[(0,H.jsx)(i.Z,{md:"6",children:(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{htmlFor:"estimated_income",children:"Estimated income"}),(0,H.jsxs)(Ie.Z,{children:[(0,H.jsx)(Ae.Z,{children:"Rp."}),(0,H.jsx)(O.Z,{type:"number",min:"1",id:"estimated_income",name:"estimated_income",onChange:ie,defaultValue:(null===v||void 0===v?void 0:v.estimated_income)||""})]})]})}),(0,H.jsx)(i.Z,{md:"6",children:(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{htmlFor:"estimated_cost",children:"Estimated cost"}),(0,H.jsxs)(Ie.Z,{children:[(0,H.jsx)(Ae.Z,{children:"Rp."}),(0,H.jsx)(O.Z,{type:"number",min:"1",id:"estimated_cost",name:"estimated_cost",onChange:ie,defaultValue:(null===v||void 0===v?void 0:v.estimated_cost)||""})]})]})})]})]}),D?(0,H.jsx)(d.Z,{children:(0,H.jsx)(i.Z,{md:"12",children:(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{for:"activity_name",children:"Add Activity Base"}),(0,H.jsxs)("div",{className:"d-flex gap-3",children:[(0,H.jsx)("div",{style:{width:"70%"},children:(0,H.jsx)(O.Z,{type:"text",name:"activity_name",id:"activity_name",placeholder:"Type here..",onChange:e=>G(e.target.value)})}),(0,H.jsx)(_.Z,{className:"d-flex align-items-center",type:"button",color:"success",size:"sm",onClick:async()=>{B(!0),q?await te.post("api/project/activity-base/add",{activity_name:q}).then((e=>{le(),(0,V.Z)("success",e.data.message)})).catch((()=>{(0,V.Z)("error","Something went wrong")})):(0,V.Z)("error","Field cannot be empty"),G(),L(!1),B(!1)},disabled:U,children:U?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(I.Z,{className:"me-2",size:"sm",color:"light"}),"Loading"]}):"Save"}),(0,H.jsx)(_.Z,{type:"button",outline:!0,onClick:()=>L(!1),disabled:U,children:"Cancel"})]})]})})}):(0,H.jsxs)(d.Z,{children:[(0,H.jsx)(i.Z,{md:"6",children:(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{for:"base_id",children:"Activity base"}),(0,H.jsxs)(O.Z,{type:"select",id:"base_id",name:"base_id",defaultValue:(null===v||void 0===v?void 0:v.base_id)||"",onChange:ie,style:{textOverflow:"ellipsis"},children:[(0,H.jsx)("option",{disabled:!0,value:"ab",children:"- Select -"}),null===f||void 0===f||null===(r=f.activity_base)||void 0===r?void 0:r.map((e=>(0,H.jsx)("option",{value:e.base_id,style:{width:"4rem",textOverflow:"ellipsis"},children:e.base_description},e.base_id))),(0,H.jsx)("option",{value:"another",children:"Tambah Lainnya"})]})]})}),(0,H.jsx)(i.Z,{md:"6",children:(0,H.jsxs)(k.Z,{children:[(0,H.jsx)(C.Z,{for:"business_id",className:"text-muted",children:"Business plan"}),"3"===(null===p||void 0===p?void 0:p.base_id)||"3"===(null===v||void 0===v||null===(c=v.base_id)||void 0===c?void 0:c.toString())?(0,H.jsx)(R.ZP,{components:se,options:null===f||void 0===f?void 0:f.business_plan,defaultValue:Q,onChange:e=>J(e)}):(0,H.jsx)(O.Z,{type:"select",disabled:!0,defaultValue:""})]})})]})]}),(0,H.jsxs)(z.Z,{children:[(0,H.jsx)(_.Z,{type:"submit",color:"info",disabled:P,children:P?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(I.Z,{className:"me-2",size:"sm",color:"light"}),"Loading ..."]}):"Update"}),(0,H.jsx)(_.Z,{color:"secondary",outline:!0,onClick:h.bind(null),children:"Cancel"})]})]})]})})},Pe=["Manager","Director"],Te=["Director"],De=e=>{var s,t,r,c,o,u,h,x,m,v,j,p;let{navActive:g,setNavActive:f,totalReview:b,totalBastReview:y}=e;const[N,k]=(0,l.useState)(""),[C,O]=(0,l.useState)(0),{auth:I}=(0,B.Z)(),{roles:F}=I.user,R=(0,M.Z)(),{projectId:E}=(0,T.UO)(),[U,q]=(0,l.useState)(!1),[G,W]=(0,l.useState)(),[J,K]=(0,l.useState)(!1),[Y,Q]=(0,l.useState)(!1),[X,$]=(0,l.useState)(!1),ee=(0,T.s0)(),se=()=>{Q(!Y)},te=new URLSearchParams(window.location.search),le=te.get("to");(0,l.useEffect)((()=>{"review"===le?f(5):"handover"===le?f(6):"overview"===le?f(1):"activities"===le?f(7):"bast-review"===le&&f(8)}),[te]),(0,l.useEffect)((()=>{null!==F&&void 0!==F&&F.find((e=>Pe.includes(e)))&&async function(){await R.get("api/task/".concat(E,"/level1/review")).then((e=>k(e.data.data))).catch((e=>console.log(e)))}()}),[b]),(0,l.useEffect)((()=>{null!==F&&void 0!==F&&F.find((e=>Te.includes(e)))&&async function(){await R.get("api/project/".concat(E,"/").concat(null===I||void 0===I?void 0:I.user.employe_id,"/bast/review")).then((e=>{O(e.data.data)})).catch((e=>console.log(e)))}()}),[y]);const{isLoading:ie,data:ne,refetch:ae}=(0,A.a)({queryKey:["project-number"],queryFn:()=>R.get("api/project/".concat(E)).then((e=>e.data.data))});(0,l.useEffect)((()=>{ae()}),[E]),(0,l.useEffect)((()=>{"business"===(null===ne||void 0===ne?void 0:ne.category)?W(!0):W(!1)}),[ne]);const de=["Staff","Manager"],re=["Staff","Manager","Director"],ce=["Manager","Director"],oe=["Staff","Manager"],ue=["Director"],he=["Manager","Director"],xe=["Manager"];return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)(i.Z,{className:"nav-container mb-3",children:[(0,H.jsxs)(d.Z,{sm:"12",lg:"8",className:"project-nav overflow-auto",children:[(0,H.jsx)(D.rU,{className:"".concat(1===g&&"active"," text-muted fw-bold"),onClick:()=>f(1),children:"Overview"}),(null===I||void 0===I||null===(s=I.user)||void 0===s?void 0:s.roles.find((e=>de.includes(e))))&&(0,H.jsx)(D.rU,{className:"".concat(2===g&&"active"," text-muted fw-bold"),onClick:()=>f(2),children:"Board"}),(null===I||void 0===I||null===(t=I.user)||void 0===t?void 0:t.roles.find((e=>ce.includes(e))))&&(0,H.jsx)(D.rU,{className:"".concat(7===g&&"active"," text-muted fw-bold"),onClick:()=>f(7),children:"Activities"}),(null===I||void 0===I||null===(r=I.user)||void 0===r?void 0:r.roles.find((e=>oe.includes(e))))&&(0,H.jsx)(H.Fragment,{children:(0,H.jsx)(D.rU,{className:"".concat(4===g&&"active"," text-muted fw-bold"),onClick:()=>f(4),children:"Files"})}),(null===I||void 0===I||null===(c=I.user)||void 0===c?void 0:c.roles.find((e=>ue.includes(e))))&&!(null!==I&&void 0!==I&&null!==(o=I.user)&&void 0!==o&&o.roles.includes("Presdir"))&&(0,H.jsxs)(D.rU,{className:"".concat(8===g&&"active"," text-muted fw-bold"),onClick:()=>f(8),children:["BAST Review"," ",(0,H.jsx)("div",{color:"danger",className:"count ".concat(C?"bg-danger text-white":"bg-light text-dark"),children:null===C||void 0===C?void 0:C.length})]}),(null===I||void 0===I||null===(u=I.user)||void 0===u?void 0:u.roles.find((e=>he.includes(e))))&&(0,H.jsx)(H.Fragment,{children:(0,H.jsxs)(D.rU,{className:"".concat(5===g&&"active"," text-muted fw-bold"),onClick:()=>f(5),children:["Review"," ",(0,H.jsx)("div",{color:"danger",className:"count ".concat((null===N||void 0===N?void 0:N.length)>0?"bg-danger text-white":"bg-light text-dark"),children:null===N||void 0===N?void 0:N.length})]})}),(null===I||void 0===I||null===(h=I.user)||void 0===h?void 0:h.roles.find((e=>xe.includes(e))))&&(0,H.jsxs)(D.rU,{className:"".concat(6===g&&"active"," text-muted fw-bold"),onClick:()=>f(6),children:["Handover"," "]}),(null===I||void 0===I||null===(x=I.user)||void 0===x?void 0:x.roles.find((e=>re.includes(e))))&&(0,H.jsx)(D.rU,{className:"".concat(3===g&&"active"," text-muted fw-bold"),onClick:()=>f(3),children:"Members"})]}),(0,H.jsx)(d.Z,{sm:"12",style:{fontSize:"20px",marginRight:"10px",textAlign:"right",minWidth:"35%"},children:(0,H.jsx)("span",{className:"fw-bold",children:ie?"Loading..":null===ne||void 0===ne?void 0:ne.project_number})})]}),(0,H.jsx)(n.Z,{className:"rounded-3 mb-3",children:(0,H.jsx)(a.Z,{children:ie?(0,H.jsx)("p",{children:"Loading..."}):(0,H.jsxs)(d.Z,{children:[(0,H.jsxs)(i.Z,{lg:"8",children:[(0,H.jsx)(d.Z,{md:"12",children:(0,H.jsx)("h5",{className:"fw-bold",children:null===ne||void 0===ne?void 0:ne.project_name})}),G?(0,H.jsxs)(d.Z,{lg:"12",children:[(0,H.jsx)(i.Z,{sm:"12 mb-2",md:"4",children:(0,H.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,H.jsx)(P(),{icon:"manage_accounts",className:"text-muted",style:{fontSize:"28px"}}),(0,H.jsxs)("div",{className:"d-flex flex-column",children:[(0,H.jsx)("span",{className:"text-muted",style:{fontSize:"10px",marginBottom:"-4px"},children:"Partner"}),(0,H.jsx)("small",{className:"fw-bold",children:(null===ne||void 0===ne||null===(m=ne.current_stage)||void 0===m?void 0:m.partner_name)||"-"})]})]})}),(0,H.jsx)(i.Z,{sm:"12 mb-2",md:"4",children:(0,H.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,H.jsx)(P(),{icon:"handshake",className:"text-muted",style:{fontSize:"28px"}}),(0,H.jsxs)("div",{className:"d-flex flex-column",children:[(0,H.jsx)("span",{className:"text-muted",style:{fontSize:"10px",marginBottom:"-4px"},children:"Schema"}),(0,H.jsx)("small",{className:"fw-bold",children:"jo"===(null===ne||void 0===ne||null===(v=ne.current_stage)||void 0===v?void 0:v.schema)?"Join Operational":"jv"===(null===ne||void 0===ne||null===(j=ne.current_stage)||void 0===j?void 0:j.schema)?"Join Venture":"-"})]})]})}),(0,H.jsx)(i.Z,{sm:"12 mb-2",md:"4",children:(0,H.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,H.jsx)(P(),{icon:"play_circle_outline",className:"text-muted",style:{fontSize:"28px"}}),(0,H.jsxs)("div",{className:"d-flex flex-column",children:[(0,H.jsx)("span",{className:"text-muted",style:{fontSize:"10px",marginBottom:"-4px"},children:"Phase"}),(0,H.jsx)("small",{className:"fw-bold",children:null===ne||void 0===ne||null===(p=ne.current_stage)||void 0===p?void 0:p.phase})]})]})})]}):(0,H.jsx)(d.Z,{lg:"12",children:(0,H.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,H.jsx)(P(),{icon:"work_off",style:{fontSize:"18px"}}),(0,H.jsx)("small",{className:"fw-bold",children:"Non-business"})]})})]}),(0,H.jsxs)(i.Z,{lg:"4",className:"d-flex align-items-center justify-content-end",children:[(0,H.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,H.jsxs)("div",{className:"d-flex flex-column align-items-end",style:{marginLeft:"10px"},children:[(0,H.jsx)("small",{className:"fw-bold",children:null===ne||void 0===ne?void 0:ne.pic_active.first_name}),(0,H.jsx)("span",{className:"fw-bold",style:{fontSize:"14px"},children:null===ne||void 0===ne?void 0:ne.pic_active.organization_name})]}),(0,H.jsx)("img",{src:L,className:"rounded-circle",alt:"avatar",width:"35",height:"35"}),(null===I||void 0===I?void 0:I.user.first_name)===(null===ne||void 0===ne?void 0:ne.created_by)?(0,H.jsxs)("div",{className:"action-table",children:[(0,H.jsx)("button",{type:"button",className:"btn d-flex",onClick:()=>q(!0),children:(0,H.jsx)(P(),{icon:"more_vert"})}),U&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("div",{className:"action-overlay",onClick:()=>q(!1)}),(0,H.jsxs)("div",{className:"action-options",children:[(0,H.jsxs)(D.rU,{type:"button",className:"text-muted",onClick:()=>{K(!0),q(void 0)},children:[(0,H.jsx)(P(),{icon:"update"}),"Update"]}),(0,H.jsxs)("button",{type:"button",className:"text-muted fw-bold",onClick:()=>{Q(!Y),q(!1)},children:[(0,H.jsx)(P(),{icon:"delete"}),"Delete"]})]})]})]}):""]}),(0,H.jsx)(Fe,{modal:J,setModal:K,toggle:()=>{K(!J)},data:ne,refetch:ae}),(0,H.jsxs)(Z.Z,{isOpen:Y,toggle:se.bind(null),centered:!0,children:[(0,H.jsx)(w.Z,{toggle:se.bind(null),children:"Confirmation"}),(0,H.jsx)(S.Z,{children:(0,H.jsxs)("div",{className:"d-flex flex-column align-items-center",children:[(0,H.jsx)("h4",{children:null===ne||void 0===ne?void 0:ne.project_name}),"Are you sure you want to delete this project?"]})}),(0,H.jsxs)(z.Z,{children:[(0,H.jsx)(_.Z,{color:"danger",size:"sm",onClick:async()=>{$(!0),await R.delete("api/project/".concat(E)).then((()=>{(0,V.Z)("success","Project has been deleted."),ee("/projects")})).catch((()=>{(0,V.Z)("error","Something went wrong.")})),Q(!Y),$(!1)},disabled:X,children:X?"Deleting..":"Yes"}),(0,H.jsx)(_.Z,{color:"secondary",size:"sm",outline:!0,onClick:se.bind(null),children:"Cancel"})]})]})]})]})})}),(0,H.jsx)(i.Z,{lg:"12",children:(0,H.jsx)(ze.Z,{color:"primary",className:"rounded-3",style:{fontSize:"14px"},children:(0,H.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,H.jsxs)("div",{children:[(0,H.jsx)("span",{children:"Ketentuan task terbaru, "}),(0,H.jsx)(D.rU,{to:"https://drive.google.com/file/d/1So2xTY9FZA8GgWkvIO7zzo8LltyloljZ/view?usp=sharing",target:"blank",style:{textDecoration:"none"},children:"Baca selengkapnya"})]}),(0,H.jsx)(P(),{icon:"info"})]})})})]})},Re={task:["satu","dua"]},Ee=(0,l.createContext)(Re),Le=(e,s)=>"SET_TASK"===s.type?{task:s.payload}:e,Me=e=>{let{children:s}=e;const[t,i]=(0,l.useReducer)(Le,Re);return(0,H.jsx)(Ee.Provider,{value:{task:t.task,dispatch:i},children:s})},Ue=()=>{const{auth:e}=(0,B.Z)(),{roles:s}=null===e||void 0===e?void 0:e.user,[t,i]=(0,l.useState)(2),[n,a]=(0,l.useState)(0),[d,r]=(0,l.useState)(0);return(0,l.useEffect)((()=>{s.includes("Director")&&i(1)}),[s]),(0,H.jsx)(Me,{children:(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(De,{navActive:t,setNavActive:i,totalReview:n,totalBastReview:d}),(0,H.jsx)(Oe,{navActive:t,setTotalReview:a,setTotalBastReview:r,roles:s})]})})}},87535:(e,s,t)=>{"use strict";t.d(s,{Z:()=>l});const l=e=>{const s=new Date(e);return"".concat(s.getDate()," ").concat(["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Aug","Sep","Oct","Nov","Des"][s.getMonth()]," ").concat(s.getFullYear())}},77904:(e,s,t)=>{"use strict";t.d(s,{Z:()=>l});const l=e=>{const s=new Date;return((new Date(e)-s)/864e5).toFixed()<1}},23606:(e,s,t)=>{"use strict";t.d(s,{Z:()=>l});const l=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e)},8453:(e,s,t)=>{"use strict";t.d(s,{Z:()=>j});var l=t(72791),i=t(52007),n=t.n(i),a=t(81694),d=t.n(a),r=t(9622),c=t(92218),o=t(47017),u=["className","cssModule","tag","type","size"];function h(){return h=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},h.apply(this,arguments)}function x(e,s){if(null==e)return{};var t,l,i=function(e,s){if(null==e)return{};var t,l,i={},n=Object.keys(e);for(l=0;l<n.length;l++)t=n[l],s.indexOf(t)>=0||(i[t]=e[t]);return i}(e,s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(l=0;l<n.length;l++)t=n[l],s.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var m={className:n().string,cssModule:n().object,size:n().string,tag:r.iC,type:n().string};function v(e){var s=e.className,t=e.cssModule,i=e.tag,n=void 0===i?"div":i,a=(e.type,e.size),m=x(e,u),v=(0,r.mx)(d()(s,"input-group",a?"input-group-".concat(a):null),t);return"dropdown"===e.type?l.createElement(c.Z,h({},m,{className:v})):l.createElement(o.K.Provider,{value:{insideInputGroup:!0}},l.createElement(n,h({},m,{className:v})))}v.propTypes=m;const j=v},71971:(e,s,t)=>{"use strict";t.d(s,{Z:()=>m});var l=t(72791),i=t(52007),n=t.n(i),a=t(81694),d=t.n(a),r=t(9622),c=["className","cssModule","tag"];function o(){return o=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},o.apply(this,arguments)}function u(e,s){if(null==e)return{};var t,l,i=function(e,s){if(null==e)return{};var t,l,i={},n=Object.keys(e);for(l=0;l<n.length;l++)t=n[l],s.indexOf(t)>=0||(i[t]=e[t]);return i}(e,s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(l=0;l<n.length;l++)t=n[l],s.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var h={className:n().string,cssModule:n().object,tag:r.iC};function x(e){var s=e.className,t=e.cssModule,i=e.tag,n=void 0===i?"span":i,a=u(e,c),h=(0,r.mx)(d()(s,"input-group-text"),t);return l.createElement(n,o({},a,{className:h}))}x.propTypes=h;const m=x},73830:(e,s,t)=>{"use strict";t.d(s,{Z:()=>m});var l=t(72791),i=t(52007),n=t.n(i),a=t(81694),d=t.n(a),r=t(9622),c=["className","cssModule","tag"];function o(){return o=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},o.apply(this,arguments)}function u(e,s){if(null==e)return{};var t,l,i=function(e,s){if(null==e)return{};var t,l,i={},n=Object.keys(e);for(l=0;l<n.length;l++)t=n[l],s.indexOf(t)>=0||(i[t]=e[t]);return i}(e,s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(l=0;l<n.length;l++)t=n[l],s.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var h={className:n().string,cssModule:n().object,tag:r.iC};function x(e){var s=e.className,t=e.cssModule,i=e.tag,n=void 0===i?"div":i,a=u(e,c),h=(0,r.mx)(d()(s,"modal-footer"),t);return l.createElement(n,o({},a,{className:h}))}x.propTypes=h;const m=x},35754:()=>{},42459:()=>{},42480:()=>{}}]);
//# sourceMappingURL=1140.b382935f.chunk.js.map