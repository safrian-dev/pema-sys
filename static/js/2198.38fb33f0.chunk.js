"use strict";(self.webpackChunkmaterialpro_main=self.webpackChunkmaterialpro_main||[]).push([[2198],{31043:(e,t,s)=>{s.d(t,{F:()=>i,Z:()=>a});s(72791);var n=s(65218),r=s(80184);const i=()=>(0,r.jsx)(n.x7,{toastOptions:{className:"",style:{}}}),a=(e,t)=>{((e,t)=>{"success"===e?n.ZP.success(t):"create"===e?(0,n.ZP)(t,{icon:"\ud83e\udd17"}):"start"===e?(0,n.ZP)("Lets get started, cheer up!",{icon:"\ud83d\udcaa"}):"done"===e?(0,n.ZP)("Horeee, task done!",{icon:"\ud83d\udc4f"}):n.ZP.error(t)})(e,t)}},22198:(e,t,s)=>{s.r(t),s.d(t,{default:()=>k});var n=s(72791),r=s(16354),i=s(43464),a=s(49037),l=s(63009),o=s(39773),d=s(19127),c=s(71513),u=s(46724),h=s(55211),v=s(94938),p=s(8118),m=s(76167),x=s(42976),g=s(55472),j=s(30690),b=s.n(j),f=s(90235),y=s(43513),Z=s(10829),O=s(57689),_=s(48089),w=s(17834),N=s(23606),S=(s(87369),s(31043)),C=s(80184);const P=(0,f.ZP)(),k=()=>{var e,t,s,j,f,k,q,R,D,A,E,Q,M,L,z,F,H,U;const{auth:I}=(0,w.Z)(),T=(0,n.useRef)(null),{assetId:V}=(0,O.UO)(),[B,K]=(0,n.useState)(!1),[J,$]=(0,n.useState)(!1),[G,W]=(0,n.useState)(!1),[X,Y]=(0,n.useState)([]),[ee,te]=(0,n.useState)(),[se,ne]=(0,n.useState)([]),[re,ie]=(0,n.useState)(""),[ae,le]=(0,n.useState)(""),[oe,de]=(0,n.useState)(""),[ce,ue]=(0,n.useState)(""),[he,ve]=(0,n.useState)(""),[pe,me]=(0,n.useState)(""),[xe,ge]=(0,n.useState)(new Date),je=(0,_.Z)(),be=(0,Z.h)({queries:[{queryKey:["assetDetail",0],queryFn:()=>je.get("dapi/inven/".concat(V)).then((e=>e.data.data))},{queryKey:["assigne",1],queryFn:()=>je.get("api/employe/assignment-list?search=all").then((e=>e.data.data))}]}),{refetch:fe}=be[0],ye=()=>{$(!J)},Ze=()=>{if(W(!G),!G){var e,t,s;le(be[0].data.name),de(be[0].data.price),ue(be[0].data.vendor),ve(be[0].data.acquisition),me(be[0].data.location);const n=[];null===(e=be[0])||void 0===e||null===(t=e.data)||void 0===t||null===(s=t.responsible_list)||void 0===s||s.map((e=>n.push({label:e.first_name,value:e.employe_id}))),Y(n)}},Oe=(e,t)=>{if(K(!B),!B){te(e);const s=[];null===t||void 0===t||t.map((e=>s.push({label:e.first_name,value:e.employe_id}))),Y(s)}},_e=e=>{Y(e)},we={weekday:"long",year:"numeric",month:"short",day:"numeric"},Ne=[{name:"Asset Number",selector:e=>e.asset_number},{name:"Responsible",selector:e=>{var t;return(0,C.jsxs)(C.Fragment,{children:[I.user.roles.includes("PicAsset")?(0,C.jsx)(r.Z,{color:"warning",onClick:()=>Oe(null===e||void 0===e?void 0:e.id,null===e||void 0===e?void 0:e.res_list),className:"ms-2",children:"+ add"}):"",null===e||void 0===e||null===(t=e.res_list)||void 0===t?void 0:t.map((e=>(0,C.jsx)(r.Z,{color:"primary",className:"ms-2",children:null===e||void 0===e?void 0:e.first_name},null===e||void 0===e?void 0:e.employe_id)))]})}},{name:"Last Udpate",selector:e=>"".concat(new Date(e.updated_at).toLocaleDateString("en-us",we)," ").concat(new Date(e.updated_at).toLocaleTimeString()," ")}];(0,n.useEffect)((()=>{fe()}),[V]);const Se={id:0,responsible:""},Ce=e=>{var t;(t=e.target.files[0],new Promise((e=>{let s="";const n=new FileReader;n.readAsDataURL(t),n.onload=()=>{s=n.result,e(s)}}))).then((e=>{(async e=>{const t={id:V,file:e};await je.post("dapi/inven/update/image",t).then((e=>{var t,s;null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.success?((0,S.Z)("success","".concat(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)),fe(),ge(new Date)):(0,S.Z)("error","failed !!")})).catch((e=>{(0,S.Z)("error",e)}))})(e)})).catch((e=>{console.log(e)}))};return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(i.Z,{children:(0,C.jsxs)(a.Z,{children:[(0,C.jsxs)(l.Z,{className:"content",children:[void 0!==(null===(e=be[0])||void 0===e||null===(t=e.data)||void 0===t?void 0:t.file)?(0,C.jsx)(o.Z,{sm:"12",lg:"5",className:" py-4 image",style:{backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundImage:"url('".concat("https://api.ptpema.co.id/","inven").concat(null===(s=be[0].data)||void 0===s?void 0:s.file,"?s=").concat(xe,"')")},children:I.user.roles.includes("PicAsset")?(0,C.jsx)("div",{className:"d-flex justify-content-end",children:(0,C.jsx)(d.Z,{color:"dark",outline:!0,className:"pb-0",size:"sm",onClick:()=>{T.current.click()},children:(0,C.jsx)(b(),{icon:"photo_camera"})})}):""}):"",(0,C.jsxs)(o.Z,{sm:"12",lg:"7",className:"py-4 text",children:[(0,C.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,C.jsx)("h2",{className:"text-bold mb-0",children:null===(j=be[0].data)||void 0===j?void 0:j.name}),I.user.roles.includes("PicAsset")?(0,C.jsx)(d.Z,{color:"dark",size:"sm",outline:!0,className:"pb-0",onClick:Ze,children:(0,C.jsx)(b(),{icon:"mode_edit"})}):""]}),(0,C.jsx)("hr",{}),(0,C.jsx)("table",{className:"w-100",children:(0,C.jsxs)("tbody",{children:[(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{children:"Parent Asset Number"}),(0,C.jsx)("td",{className:"text-end",children:null===(f=be[0].data)||void 0===f?void 0:f.asset_number})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{children:"Type"}),(0,C.jsx)("td",{className:"text-end",children:null===(k=be[0].data)||void 0===k?void 0:k.type_name})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{children:"Acquisition Price"}),(0,C.jsx)("td",{className:"text-end",children:(0,N.Z)(null===(q=be[0].data)||void 0===q?void 0:q.price)})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{children:"Current Asset Value"}),(0,C.jsx)("td",{className:"text-end",children:(0,N.Z)(null===(R=be[0].data)||void 0===R?void 0:R.current)})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{children:"Vendor"}),(0,C.jsx)("td",{className:"text-end",children:null===(D=be[0].data)||void 0===D?void 0:D.vendor})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{children:"Acquisition Time"}),(0,C.jsx)("td",{className:"text-end",children:null===(A=be[0].data)||void 0===A?void 0:A.acquisition})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{children:"Age "}),(0,C.jsx)("td",{className:"text-end",children:null===(E=be[0].data)||void 0===E?void 0:E.old})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{children:"Amount "}),(0,C.jsxs)("td",{className:"text-end",children:[null===(Q=be[0].data)||void 0===Q?void 0:Q.amount," items"]})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{children:"Location "}),(0,C.jsx)("td",{className:"text-end",children:null===(M=be[0].data)||void 0===M?void 0:M.location})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{children:"Last Update"}),(0,C.jsx)("td",{className:"text-end",children:"".concat(new Date(null===(L=be[0].data)||void 0===L?void 0:L.updated_at).toLocaleDateString("en-us",we)," ").concat(new Date(null===(z=be[0].data)||void 0===z?void 0:z.updated_at).toLocaleTimeString())})]}),(0,C.jsxs)("tr",{children:[(0,C.jsx)("td",{children:"Responsible "}),(0,C.jsx)("td",{className:"text-end",children:null===(F=be[0].data)||void 0===F||null===(H=F.responsible_list)||void 0===H?void 0:H.map((e=>(0,C.jsx)(r.Z,{color:"primary",className:"ms-2",children:null===e||void 0===e?void 0:e.first_name},null===e||void 0===e?void 0:e.employe_id)))})]})]})})]})]}),(0,C.jsx)(y.ZP,{className:"mt-0",columns:Ne,data:null===(U=be[0].data)||void 0===U?void 0:U.child,pagination:!0,selectableRows:!!I.user.roles.includes("PicAsset")||"",onSelectedRowsChange:e=>{let{selectedRows:t}=e;ne(t)},subHeader:!0,subHeaderComponent:I.user.roles.includes("PicAsset")?(0,C.jsxs)(c.Z,{className:"me-auto mt-5",size:"sm",children:[(0,C.jsx)(d.Z,{className:"pb-0",outline:!0,disabled:0===(null===se||void 0===se?void 0:se.length),onClick:async()=>{await je.post("dapi/inven/child/del",{data:se}).then((e=>{var t,s,n;null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.success?((0,S.Z)("success","".concat(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)),fe(),ne([])):(0,S.Z)("error","".concat(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message))})).catch((e=>{Oe(),ne([]),(0,S.Z)("error",e)}))},children:(0,C.jsx)(b(),{icon:"delete_forever"})}),(0,C.jsx)(d.Z,{outline:!0,color:"success",onClick:ye,children:"+ Add Child"})]}):""})]})}),(0,C.jsxs)(u.Z,{isOpen:B,toggle:Oe,children:[(0,C.jsx)(h.Z,{toggle:Oe,children:"Add Another Employee"}),(0,C.jsxs)(v.Z,{children:[(0,C.jsx)(g.ZP,{components:P,isMulti:!0,value:X,options:be[1].data,onChange:_e,isClearable:X.some((e=>!e.isFixed))}),(0,C.jsx)("div",{className:"d-grid gap-2 mt-3",children:(0,C.jsx)(d.Z,{onClick:()=>(async()=>{const e=[];null===X||void 0===X||X.map((t=>e.push("//".concat(t.value,"//")))),Se.id=ee,Se.responsible=e.toLocaleString(),await je.post("dapi/inven/child/update",Se).then((e=>{var t;null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.success&&(Oe(),fe())})).catch((e=>{Oe(),(0,S.Z)("error",e)}))})(),children:"Update Data"})})]})]}),(0,C.jsxs)(u.Z,{isOpen:J,toggle:ye,children:[(0,C.jsx)(h.Z,{toggle:ye,children:"Set Number Of Child"}),(0,C.jsxs)(v.Z,{children:[(0,C.jsx)(p.Z,{type:"number",min:"1",onChange:e=>ie(e.target.value)}),(0,C.jsx)("div",{className:"d-grid gap-2 mt-3",children:(0,C.jsx)(d.Z,{onClick:()=>(async()=>{const e={id_parent:+V,amount:+re};console.log(e),await je.post("dapi/inven/child/add",e).then((e=>{var t;null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.success&&(ye(),fe(),(0,S.Z)("success","added succesfully !"))})).catch((e=>{ye(),(0,S.Z)("error",e)}))})(),children:"Add Childs"})})]})]}),(0,C.jsxs)(u.Z,{isOpen:G,toggle:Ze,children:[(0,C.jsx)(h.Z,{toggle:Ze,children:"New Inventory Data"}),(0,C.jsxs)(v.Z,{children:[(0,C.jsxs)(m.Z,{children:[(0,C.jsx)(x.Z,{for:"in_name",children:"Inventory Name"}),(0,C.jsx)(p.Z,{id:"in_name",name:"in_name",type:"text",onChange:e=>le(e.target.value),value:ae})]}),(0,C.jsxs)(m.Z,{children:[(0,C.jsx)(x.Z,{for:"in_harga_beli",children:"Purchase Price"}),(0,C.jsx)(p.Z,{id:"in_harga_beli",name:"in_harga_beli",type:"number",onChange:e=>de(e.target.value),value:oe})]}),(0,C.jsxs)(m.Z,{children:[(0,C.jsxs)(x.Z,{for:"in_vendor",children:["Vendor ",(0,C.jsx)("small",{children:"(optional)"})]}),(0,C.jsx)(p.Z,{id:"in_vendor",name:"in_vendor",type:"text",accept:"image/*",onChange:e=>ue(e.target.value),value:ce})]}),(0,C.jsxs)(m.Z,{children:[(0,C.jsx)(x.Z,{for:"time",children:"Acquisition Time"}),(0,C.jsx)(p.Z,{id:"time",name:"date",placeholder:"date placeholder",type:"date",onChange:e=>ve(e.target.value),value:he})]}),(0,C.jsxs)(m.Z,{children:[(0,C.jsx)(x.Z,{for:"in_location",children:"Detail Location"}),(0,C.jsx)(p.Z,{id:"in_location",name:"in_location",type:"textarea",onChange:e=>me(e.target.value),value:pe})]}),(0,C.jsxs)(m.Z,{children:[(0,C.jsx)(x.Z,{for:"in_harga_beli",children:"Responsible"}),(0,C.jsx)(g.ZP,{components:P,isMulti:!0,value:X,options:be[1].data,onChange:_e})]}),(0,C.jsx)(m.Z,{children:(0,C.jsx)("div",{className:"d-grid gap-2 mt-4",children:(0,C.jsx)(d.Z,{type:"submit",onClick:async()=>{const e=[];null===X||void 0===X||X.map((t=>e.push("//".concat(t.value,"//"))));const t={id:V,name:ae,price:oe,vendor:ce,acquisition:he,location:pe,responsible:e.toLocaleString()};await je.post("dapi/inven/update",t).then((e=>{var t,s,n;(Ze(),null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.success)?((0,S.Z)("success","".concat(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)),fe()):(0,S.Z)("error","".concat(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message))})).catch((e=>{Ze(),(0,S.Z)("error",e)})),console.log(t)},children:"Save Data"})})})]})]}),(0,C.jsx)("input",{style:{display:"none"},ref:T,type:"file",accept:"image/*",onChange:e=>Ce(e)})]})}},23606:(e,t,s)=>{s.d(t,{Z:()=>n});const n=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e)},71513:(e,t,s)=>{s.d(t,{Z:()=>x});var n=s(72791),r=s(52007),i=s.n(r),a=s(81694),l=s.n(a),o=s(9622),d=["className","cssModule","size","vertical","tag"];function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},c.apply(this,arguments)}function u(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function h(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function v(e,t){if(null==e)return{};var s,n,r=function(e,t){if(null==e)return{};var s,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(r[s]=e[s]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}var p={"aria-label":i().string,className:i().string,cssModule:i().object,role:i().string,size:i().string,tag:o.iC,vertical:i().bool};function m(e){var t=e.className,s=e.cssModule,r=e.size,i=e.vertical,a=e.tag,p=void 0===a?"div":a,m=v(e,d),x=(0,o.mx)(l()(t,!!r&&"btn-group-"+r,i?"btn-group-vertical":"btn-group"),s);return n.createElement(p,c({},function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?u(Object(s),!0).forEach((function(t){h(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):u(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({role:"group"},m),{className:x}))}m.propTypes=p;const x=m},87369:()=>{},10829:(e,t,s)=>{s.d(t,{h:()=>m});var n=s(72791),r=s(73734),i=s(69538),a=s(21135),l=s(55511);class o extends l.l{constructor(e,t){super(),this.client=e,this.queries=[],this.result=[],this.observers=[],this.observersMap={},t&&this.setQueries(t)}onSubscribe(){1===this.listeners.size&&this.observers.forEach((e=>{e.subscribe((t=>{this.onUpdate(e,t)}))}))}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.observers.forEach((e=>{e.destroy()}))}setQueries(e,t){this.queries=e,i.V.batch((()=>{const e=this.observers,s=this.findMatchingObservers(this.queries);s.forEach((e=>e.observer.setOptions(e.defaultedQueryOptions,t)));const n=s.map((e=>e.observer)),i=Object.fromEntries(n.map((e=>[e.options.queryHash,e]))),a=n.map((e=>e.getCurrentResult())),l=n.some(((t,s)=>t!==e[s]));(e.length!==n.length||l)&&(this.observers=n,this.observersMap=i,this.result=a,this.hasListeners()&&((0,r.e5)(e,n).forEach((e=>{e.destroy()})),(0,r.e5)(n,e).forEach((e=>{e.subscribe((t=>{this.onUpdate(e,t)}))})),this.notify()))}))}getCurrentResult(){return this.result}getQueries(){return this.observers.map((e=>e.getCurrentQuery()))}getObservers(){return this.observers}getOptimisticResult(e){return this.findMatchingObservers(e).map((e=>e.observer.getOptimisticResult(e.defaultedQueryOptions)))}findMatchingObservers(e){const t=this.observers,s=new Map(t.map((e=>[e.options.queryHash,e]))),n=e.map((e=>this.client.defaultQueryOptions(e))),r=n.flatMap((e=>{const t=s.get(e.queryHash);return null!=t?[{defaultedQueryOptions:e,observer:t}]:[]})),i=new Set(r.map((e=>e.defaultedQueryOptions.queryHash))),l=n.filter((e=>!i.has(e.queryHash))),o=new Set(r.map((e=>e.observer))),d=t.filter((e=>!o.has(e))),c=e=>{const t=this.client.defaultQueryOptions(e),s=this.observersMap[t.queryHash];return null!=s?s:new a.z(this.client,t)},u=l.map(((e,t)=>{if(e.keepPreviousData){const s=d[t];if(void 0!==s)return{defaultedQueryOptions:e,observer:s}}return{defaultedQueryOptions:e,observer:c(e)}}));return r.concat(u).sort(((e,t)=>n.indexOf(e.defaultedQueryOptions)-n.indexOf(t.defaultedQueryOptions)))}onUpdate(e,t){const s=this.observers.indexOf(e);-1!==s&&(this.result=(0,r.Rc)(this.result,s,t),this.notify())}notify(){i.V.batch((()=>{this.listeners.forEach((e=>{let{listener:t}=e;t(this.result)}))}))}}var d=s(97413),c=s(96403),u=s(30909),h=s(76153),v=s(49952),p=s(38447);function m(e){let{queries:t,context:s}=e;const r=(0,c.NL)({context:s}),a=(0,u.S)(),l=(0,h._)(),m=n.useMemo((()=>t.map((e=>{const t=r.defaultQueryOptions(e);return t._optimisticResults=a?"isRestoring":"optimistic",t}))),[t,r,a]);m.forEach((e=>{(0,p.Fb)(e),(0,v.pf)(e,l)})),(0,v.JN)(l);const[x]=n.useState((()=>new o(r,m))),g=x.getOptimisticResult(m);(0,d.$)(n.useCallback((e=>a?()=>{}:x.subscribe(i.V.batchCalls(e))),[x,a]),(()=>x.getCurrentResult()),(()=>x.getCurrentResult())),n.useEffect((()=>{x.setQueries(m,{listeners:!1})}),[m,x]);const j=g.some(((e,t)=>(0,p.SB)(m[t],e,a)))?g.flatMap(((e,t)=>{const s=m[t],n=x.getObservers()[t];if(s&&n){if((0,p.SB)(s,e,a))return(0,p.j8)(s,n,l);(0,p.Z$)(e,a)&&(0,p.j8)(s,n,l)}return[]})):[];if(j.length>0)throw Promise.all(j);const b=x.getQueries(),f=g.find(((e,t)=>{var s,n;return(0,v.KJ)({result:e,errorResetBoundary:l,useErrorBoundary:null!=(s=null==(n=m[t])?void 0:n.useErrorBoundary)&&s,query:b[t]})}));if(null!=f&&f.error)throw f.error;return g}}}]);
//# sourceMappingURL=2198.38fb33f0.chunk.js.map